# NeoAgent 环境变量配置示例
# @author: sun977
# @date: 2025.10.21
# @description: Agent端环境变量配置示例，复制为.env文件并修改相应值

# ================================
# 基础配置
# ================================

# 运行环境 (development, production, test)
ENVIRONMENT=development

# 服务器配置
SERVER_PORT=8081
SERVER_HOST=0.0.0.0
SERVER_DEBUG=false

# ================================
# 数据库配置
# ================================

# 数据库类型 (sqlite, mysql, postgres)
DB_TYPE=sqlite
# SQLite数据库文件路径
DB_DSN=data/agent.db
# MySQL/PostgreSQL连接字符串示例
# DB_DSN=user:password@tcp(localhost:3306)/neoagent?charset=utf8mb4&parseTime=True&loc=Local
# DB_DSN=host=localhost user=neoagent password=password dbname=neoagent port=5432 sslmode=disable TimeZone=Asia/Shanghai

# 数据库连接池配置
DB_MAX_IDLE_CONNS=10
DB_MAX_OPEN_CONNS=100
DB_CONN_MAX_LIFETIME=1h

# ================================
# Master连接配置
# ================================

# Master服务器地址
MASTER_ADDRESS=localhost
MASTER_PORT=8080
MASTER_PROTOCOL=http

# TLS配置
MASTER_ENABLE_TLS=false
MASTER_TLS_CERT_PATH=
MASTER_TLS_KEY_PATH=
MASTER_CA_CERT_PATH=

# 连接超时配置
MASTER_CONNECT_TIMEOUT=10s
MASTER_REQUEST_TIMEOUT=30s
MASTER_HEARTBEAT_INTERVAL=30s
MASTER_RECONNECT_INTERVAL=5s
MASTER_MAX_RECONNECT_ATTEMPTS=10

# ================================
# Agent配置
# ================================

# Agent标识 (留空自动生成)
AGENT_ID=
AGENT_NAME=neoagent
AGENT_VERSION=1.0.0
AGENT_TYPE=scanner

# Agent标签 (逗号分隔)
AGENT_TAGS=scanner,security

# 工作目录配置
AGENT_WORK_DIR=./work
AGENT_TEMP_DIR=./temp
AGENT_LOG_DIR=./logs
AGENT_DATA_DIR=./data

# 任务配置
AGENT_MAX_CONCURRENT_TASKS=10
AGENT_TASK_TIMEOUT=30m
AGENT_AUTO_REGISTER=true

# ================================
# 安全配置
# ================================

# API密钥 (必须设置)
AGENT_API_KEY=your-secret-api-key-here

# JWT配置
JWT_SECRET=your-jwt-secret-key-here
JWT_EXPIRATION=24h

# 数据加密密钥 (32字符)
ENCRYPTION_KEY=your-32-character-encryption-key

# IP白名单 (逗号分隔，留空表示不启用)
IP_WHITELIST=

# ================================
# 日志配置
# ================================

# 日志级别 (debug, info, warn, error)
LOG_LEVEL=info
# 日志格式 (json, text)
LOG_FORMAT=json
# 日志输出 (console, file, both)
LOG_OUTPUT=file
# 日志文件路径
LOG_FILE_PATH=logs/agent.log
# 日志文件大小限制 (MB)
LOG_MAX_SIZE=100
# 日志文件备份数量
LOG_MAX_BACKUPS=10
# 日志文件保留天数
LOG_MAX_AGE=30
# 是否压缩日志文件
LOG_COMPRESS=true

# ================================
# 中间件配置
# ================================

# 认证中间件
AUTH_ENABLED=true
AUTH_TYPE=api_key

# 日志中间件
LOGGING_ENABLE_REQUEST_LOG=true
LOGGING_ENABLE_RESPONSE_LOG=true
LOGGING_LOG_REQUEST_BODY=false
LOGGING_LOG_RESPONSE_BODY=false
LOGGING_SLOW_REQUEST_THRESHOLD=2s

# CORS中间件
CORS_ENABLED=true
CORS_ALLOW_ALL_ORIGINS=true
CORS_ALLOW_CREDENTIALS=false

# 限流中间件
RATE_LIMIT_ENABLED=true
RATE_LIMIT_REQUESTS_PER_SECOND=100
RATE_LIMIT_BURST_SIZE=200
RATE_LIMIT_STRATEGY=token_bucket

# ================================
# 执行器配置
# ================================

# 工具路径配置
NMAP_PATH=/usr/bin/nmap
NUCLEI_PATH=/usr/local/bin/nuclei
MASSCAN_PATH=/usr/bin/masscan

# Nuclei模板目录
NUCLEI_TEMPLATES_DIR=./nuclei-templates

# 资源限制
EXECUTOR_CPU_LIMIT=2.0
EXECUTOR_MEMORY_LIMIT=2048
EXECUTOR_DISK_LIMIT=10240
EXECUTOR_NETWORK_LIMIT=100
EXECUTOR_PROCESSES_LIMIT=50
EXECUTOR_FILE_DESCRIPTORS_LIMIT=1024

# ================================
# 监控配置
# ================================

# 监控开关
MONITOR_ENABLED=true
MONITOR_INTERVAL=30s
MONITOR_RETENTION_PERIOD=24h

# 告警配置
ALERT_HIGH_CPU_THRESHOLD=80.0
ALERT_HIGH_MEMORY_THRESHOLD=90.0
ALERT_LOW_DISK_THRESHOLD=85.0

# ================================
# 开发调试配置
# ================================

# 开发模式
DEV_MODE=false
# 调试端口
DEBUG_PORT=6060
# 性能分析
ENABLE_PPROF=false
# 详细日志
VERBOSE_LOGGING=false

# ================================
# 外部服务配置
# ================================

# Redis配置 (可选)
REDIS_ADDRESS=localhost:6379
REDIS_PASSWORD=
REDIS_DB=0

# 消息队列配置 (可选)
MQ_TYPE=redis
MQ_ADDRESS=localhost:6379
MQ_PASSWORD=
MQ_DB=1

# ================================
# 备注说明
# ================================

# 1. 复制此文件为 .env 并修改相应配置值
# 2. 敏感信息如API密钥、JWT密钥等必须设置
# 3. 生产环境建议使用强密码和加密传输
# 4. 工具路径需要根据实际安装位置调整
# 5. 资源限制需要根据服务器配置调整