# SweetBabyScan 命令参数说明

SweetBabyScan（又称SbScan）是一款轻量级内网资产探测与漏洞扫描工具，支持多种网络协议和服务的自动化检测与弱口令爆破。本文档详细介绍了所有可用的命令行参数。

## 基本用法

```bash
./SbScan [参数]
```

## 参数分类说明

### 1. 扫描配置参数

| 参数缩写 | 完整参数 | 默认值 | 说明 |
|---------|----------|--------|------|
| -h | --host | 192.168.0.0/16,172.16.0.0/12,10.0.0.0/8 | 检测网段/域名，或者txt文件[以.txt结尾，一行一组回车换行] |
| -p | --port | web | 端口范围：tiny[精简]、web[WEB服务]、normal[常用]、database[数据库]、caffe[咖啡厅/酒店/机场]、iot[物联网]、all[全部]、自定义 |
| -pt | --protocol | tcp+udp | 端口范围：tcp、udp、tcp+udp |
| -hb | --hostBlack | | 排除网段 |

### 2. 存活检测参数

| 参数缩写 | 完整参数 | 默认值 | 说明 |
|---------|----------|--------|------|
| -msh | --methodScanHost | ICMP | 验存方式：PING、ICMP |
| -wsh | --workerScanHost | 250 | 存活并发 |
| -tsh | --timeOutScanHost | 3 | 存活超时 |

### 3. 端口扫描参数

| 参数缩写 | 完整参数 | 默认值 | 说明 |
|---------|----------|--------|------|
| -wsp | --workerScanPort | 250 | 扫描并发 |
| -tspc | --timeOutScanPortConnect | 6 | 端口扫描连接超时 |
| -tsps | --timeOutScanPortSend | 6 | 端口扫描发包超时 |
| -tspr | --timeOutScanPortRead | 6 | 端口扫描读取超时 |
| -r | --rarity | 10 | 优先级 |

### 4. 网站扫描参数

| 参数缩写 | 完整参数 | 默认值 | 说明 |
|---------|----------|--------|------|
| -wss | --workerScanSite | runtime.NumCPU()*2 | 爬虫并发 |
| -tss | --timeOutScanSite | 6 | 爬虫超时 |
| -ts | --timeOutScreen | 60 | 截图超时 |

### 5. POC扫描参数

| 参数缩写 | 完整参数 | 默认值 | 说明 |
|---------|----------|--------|------|
| -lpn | --listPocNuclei | false | 列举Poc Nuclei |
| -lpx | --ListPocXray | false | 列举Poc Xray |
| -fpn | --filterPocName | | 筛选POC名称，多个关键字英文逗号隔开 |
| -fvl | --filterVulLevel | | 筛选POC严重等级：critical[严重] > high[高危] > medium[中危] > low[低危] > info[信息]、unknown[未知]、all[全部]，多个关键字英文逗号隔开 |
| -tspn | --timeOutScanPocNuclei | 6 | PocNuclei扫描超时 |
| -wsPoc | --workerScanPoc | 100 | Poc并发 |

### 6. 弱口令扫描参数

| 参数缩写 | 完整参数 | 默认值 | 说明 |
|---------|----------|--------|------|
| -gsw | --groupScanWeak | 20 | 爆破分组 |
| -wsw | --workerScanWeak | ssh:1,smb:1,rdp:1,snmp:1,sqlserver:4,mysql:4,mongodb:4,postgres:4,redis:6,ftp:1,clickhouse:4,elasticsearch:4,oracle:4,memcached:4 | 爆破并发，键值对形式，英文逗号分隔 |
| -tsw | --timeOutScanWeak | 6 | 爆破超时 |
| -ssw | --serviceScanWeak | | 指定爆破协议 |
| -au | --aUser | | 追加弱口令账号字典[以.txt结尾] |
| -ap | --aPass | | 追加弱口令密码字典[以.txt结尾] |
| -wu | --wUser | | 覆盖弱口令账号字典[以.txt结尾] |
| -wp | --wPass | | 覆盖弱口令密码字典[以.txt结尾] |
| -iap | --isAPass | false | 追加弱口令生成器 |
| -iwp | --isWPass | false | 覆盖弱口令生成器 |
| -pp | --passwordPrefix | | 密码前缀，多个英文逗号分隔 |
| -pc | --passwordCenter | | 密码中位，多个英文逗号分隔 |
| -ps | --passwordSuffix | | 密码后缀，多个英文逗号分隔 |

### 7. 功能开关参数

| 参数缩写 | 完整参数 | 默认值 | 说明 |
|---------|----------|--------|------|
| -il | --isLog | true | 显示日志 |
| -is | --isScreen | true | 启用截图 |
| -nsh | --noScanHost | false | 跳过主机存活检测 |
| -nsw | --noScanWeak | false | 跳过弱口令爆破 |
| -nsp | --noScanPoc | false | 跳过POC漏洞验证 |
| -nsv | --noScanVul | false | 跳过高危系统漏洞探测 |

### 8. 输出配置参数

| 参数缩写 | 完整参数 | 默认值 | 说明 |
|---------|----------|--------|------|
| -oe | --outputExcel | | 指定保存excel文件路径[以.xlsx结尾] |
| -ot | --outputTxt | | 指定保存txt文件路径[以.txt结尾] |

### 9. 穿透代理功能参数

| 参数缩写 | 完整参数 | 默认值 | 说明 |
|---------|----------|--------|------|
| -pf | --portForward | false | 开启端口转发 |
| -sh | --sourceHost | | 目标转发主机 |
| -lp | --localPort | 0 | 本机代理端口 |
| -pm | --portMap | false | 开启内网穿透 |
| -pmc | --portMapClient | false | 开启内网穿透-客户端 |
| -pms | --portMapServer | false | 开启内网穿透-服务端 |
| -pmcs | --portMapClientSock5 | false | 开启内网穿透-客户端Sock5 |
| -sp | --sock5Port | 9189 | Sock5监听端口 |
| -sau | --sock5AuthUsername | | Sock5鉴权账号 |
| -sap | --sock5AuthPassword | | Sock5鉴权密码 |
| -s | --secret | SBScan | 穿透密钥，自定义 |
| -psl | --portServerListen | 9188 | 穿透服务端监听端口 |
| -su | --serverUri | | 穿透服务端地址，公网IP:端口 |
| -pcm | --portClientMap | | 穿透客户端映射字典，多个英文逗号隔开，格式：8080-127.0.0.1:8080,9000-192.168.188.1:9000 |

## 使用示例

### 1. 基本扫描
```bash
./SbScan -h=192.168.188.1/24
```

### 2. 指定端口扫描
```bash
./SbScan -h=192.168.188.1/24 -p=tiny
./SbScan -h=192.168.188.1/24,10.0.0.1/16 -p=22,80,443
```

### 3. 混合IP和域名扫描
```bash
./SbScan -h=192.168.188.1/24,10.0.0.1/24,www.a.com,www.b.xyz,www.c.net
```

### 4. 高性能扫描
```bash
./SbScan -wsh=2048 -wsp=1024 -h=192.168.188.1/24,10.0.0.1/16 -p=22,80,443
```

### 5. 跳过某些检测阶段
```bash
./SbScan -nsh -nsw -h=192.168.188.1/24  # 跳过主机存活检测和弱口令爆破
```

### 6. 列出POC
```bash
./SbScan --lpn --fpn weblogic  # 列出weblogic漏洞对应的poc
./SbScan --lpn --fpn thinkphp  # 列出thinkphp漏洞对应的poc
```

### 7. 设置输出路径
```bash
./SbScan -h=192.168.188.1/24 -oe ./result.xlsx -ot ./result.txt
```

## 注意事项

1. 所有参数都可以使用短参数（单字母）或长参数（完整单词）形式
2. 端口参数支持预设类型（tiny、web、normal、database、cafè、iot、all）或自定义端口范围
3. 弱口令爆破功能仅应在授权范围内使用
4. 高并发扫描可能对网络造成压力，请根据实际情况调整并发数
5. 某些功能需要特定权限（如ICMP检测需要管理员权限）