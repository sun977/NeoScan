# Agent å¼€å‘è¿›åº¦è¯„ä¼° (æˆªè‡³ 2026-01-21)

## æ ¸å¿ƒçŠ¶æ€æ¦‚è§ˆ

**"Foundation First. Speed Second."**
Agent æ­£å¤„äºä» "HTTP Worker" å‘ "Native Scanner" çš„å…³é”®è½¬å‹æœŸã€‚
Cobra CLI æ¶æ„å’Œ Core Task æ¨¡å‹å·²å»ºç«‹ï¼ŒOptions å¼ºç±»å‹å‚æ•°è§£æå·²å°±ç»ªã€‚
ç°åœ¨è¿›å…¥ **Phase 3: åŸç”Ÿèƒ½åŠ›å®ç° (Execution Phase)**ã€‚

*   **Architecture (æ¶æ„)**: **90%**ã€‚Cobra å‘½ä»¤æ ‘ã€Options æ¨¡å¼ã€Core Task æ¨¡å‹å·²å®Œæˆï¼ŒReporter æ¥å£å·²å®šä¹‰ã€‚
*   **Core Capability (æ ¸å¿ƒèƒ½åŠ›)**: **30%**ã€‚IpAliveScanner å·²å®ç°å¹¶é›†æˆï¼ŒConsole Reporter æ”¯æŒè¡¨æ ¼è¾“å‡ºã€‚
*   **Infrastructure (åŸºç¡€è®¾æ–½)**: **50%**ã€‚åŸºç¡€ç›®å½•ç»“æ„å·²å°±ç»ªï¼Œæ„å»ºæµç¨‹ç•…é€šã€‚
*   **Connectivity (è¿æ¥æ€§)**: **50%**ã€‚`server` å‘½ä»¤å·²æ”¯æŒ Token å‚æ•°ï¼Œä½†ä¸ Master çš„å®é™…é€šä¿¡é€»è¾‘éœ€é€‚é…æ–°æ¶æ„ã€‚

---

## 1. æ¨¡å—è¯¦ç»†è¯„ä¼°

### 1.1 Core Decoupling (æ ¸å¿ƒè§£è€¦) - "The Foundation"
| ç»„ä»¶ | çŠ¶æ€ | å¤‡æ³¨ |
| :--- | :--- | :--- |
| **Directory Structure** | ğŸŸ¢ **Done** | `internal/core` å·²åˆ›å»ºã€‚ |
| **Task Model** | ğŸŸ¢ **Done** | `model.Task` å·²å®šä¹‰ï¼Œæ”¯æŒå¤šç§æ‰«æç±»å‹ã€‚ |
| **Service Logic** | ğŸŸ¢ **Done** | Scanner/Runner æ¥å£å·²å®šä¹‰ (`runner/interface.go`)ã€‚ |
| **Reporter** | ğŸŸ¢ **Done** | `ConsoleReporter` å·²å®ç°ï¼Œæ”¯æŒ Tabular è¾“å‡ºã€‚ |

### 1.2 CLI Transformation (CLI æ”¹é€ ) - "The Interface"
| ç»„ä»¶ | çŠ¶æ€ | å¤‡æ³¨ |
| :--- | :--- | :--- |
| **Cobra Entry** | ğŸŸ¢ **Done** | `main.go` å·²é‡å†™ï¼Œ`root.go` é›†æˆ Viperã€‚ |
| **Server Command** | ğŸŸ¢ **Done** | æ”¯æŒ `--master` å’Œ `--token` å‚æ•°ã€‚ |
| **Scan Command** | ğŸŸ¢ **Done** | 8ç§æ‰«æå­å‘½ä»¤ (Alive, Port, Service, OS, Web, Dir, Vuln, Subdomain) å·²å°±ç»ªã€‚ |
| **Proxy Command** | ğŸŸ¢ **Done** | æ”¯æŒ Socks5/HTTP/PortForward æ¨¡å¼å‚æ•°è§£æã€‚ |
| **Output Config** | ğŸŸ¢ **Done** | å…¨å±€æ”¯æŒ CSV/JSON è¾“å‡º (`--oc`, `--oj`)ã€‚ |

### 1.3 Native Capabilities (åŸç”Ÿèƒ½åŠ›) - "The Power"
| ç»„ä»¶ | çŠ¶æ€ | å¤‡æ³¨ |
| :--- | :--- | :--- |
| **Concurrency** | ğŸŸ¡ **Partial** | `IpAliveScanner` ä¸­å®ç°äº†åŸºç¡€çš„ Semaphoreï¼Œéœ€æ¨å¹¿åˆ°é€šç”¨ Runnerã€‚ |
| **Host Discovery** | ğŸŸ¢ **Done** | `IpAliveScanner` å·²å®ç° ICMP æ¢æµ‹ã€‚ |
| **Port Scan** | ğŸ”´ **Pending** | åŸç”Ÿ TCP SYN/Connect Scanã€‚ |
| **Web Finger** | ğŸ”´ **Pending** | åŸºäº `httpx` æˆ–åŸç”Ÿ HTTP åº“çš„æŒ‡çº¹è¯†åˆ«ã€‚ |

### 1.4 Cluster Integration (é›†ç¾¤é›†æˆ) - "The Connection"
| ç»„ä»¶ | çŠ¶æ€ | å¤‡æ³¨ |
| :--- | :--- | :--- |
| **Join Protocol** | ğŸŸ¢ **Done** | CLI å‚æ•°å·²æ”¯æŒ Tokenï¼ŒåºŸé™¤ç‹¬ç«‹çš„ Join å‘½ä»¤ã€‚ |
| **Auth Storage** | ğŸŸ¡ **Partial** | Viper å·²ç»‘å®š Tokenï¼Œéœ€ç¡®ä¿æŒä¹…åŒ–ã€‚ |
| **Task Pulling** | ğŸŸ¡ **Legacy** | æ—§ç‰ˆ HTTP è½®è¯¢é€»è¾‘å­˜åœ¨ï¼Œéœ€é€‚é…æ–° Coreã€‚ |

---

## 2. ä¸‹ä¸€æ­¥è¡ŒåŠ¨ (Next Steps)

**"Stop designing. Start coding."**

### P0: Phase 3 - åŸç”Ÿèƒ½åŠ›å»ºè®¾ (Native Capabilities)
*   **ç›®æ ‡**: è®© `neoAgent scan` çœŸæ­£è·‘èµ·æ¥ã€‚
*   **è¡ŒåŠ¨**:
    1.  å®šä¹‰ `internal/core/runner` æ¥å£ã€‚
    2.  å®ç°åŸºç¡€å¹¶å‘æ¨¡å‹ (Worker Pool)ã€‚
    3.  å®ç° `AssetScanner` (Ping + Port Check)ã€‚

### P1: Phase 4 - é›†ç¾¤é€‚é… (Cluster Adapter)
*   **ç›®æ ‡**: è®© `neoAgent server` ä½¿ç”¨æ–°çš„ Runnerã€‚
*   **è¡ŒåŠ¨**:
    1.  é‡æ„ `server` å¾ªç¯ï¼Œä½¿å…¶ä» Master æ‹‰å– Task å¹¶è½¬æ¢ä¸º `model.Task`ã€‚
    2.  è°ƒç”¨ `Runner` æ‰§è¡Œä»»åŠ¡ã€‚
    3.  ä¸ŠæŠ¥ç»“æœã€‚

---

## 3. é£é™©ä¸é˜»ç¢ (Risks & Blockers)

*   **é£é™©**: å¤–éƒ¨å·¥å…·ä¾èµ–ã€‚Masscan/Nmap/Nuclei çš„è°ƒç”¨å°è£…å¯èƒ½æ¯”è¾ƒå¤æ‚ï¼Œéœ€è¦å¤„ç†è·¨å¹³å°è·¯å¾„å’Œæƒé™é—®é¢˜ã€‚
*   **é˜»ç¢**: æ— ã€‚

---

**Linus's Verdict (å½“å‰è£å†³)**:

CLI éª¨æ¶å’Œæ ¸å¿ƒæ•°æ®ç»“æ„å·²ç»éå¸¸æ¼‚äº®ã€‚
æˆ‘ä»¬å·²ç»æœ‰äº†æªï¼ˆCLIï¼‰ï¼Œæœ‰äº†å­å¼¹è§„æ ¼ï¼ˆTask Modelï¼‰ï¼Œç°åœ¨éœ€è¦é€ **æ’é’ˆï¼ˆRunnerï¼‰**ã€‚
ç«‹å³å¯åŠ¨ **Phase 3: åŸç”Ÿèƒ½åŠ›å»ºè®¾**ã€‚
