# 资产类型对照表

本文档将资产分类内容整理为表格形式，明确了每种资产类型在不同阶段的表现形式。

| 资产大类 | 资产类型(asset_type) | 目标类型(target_type) | 结果类型(result_type) | 工作流阶段归一实体 | 说明 |
|---------|---------------------|----------------------|----------------------|------------------|------|
| IP/网段资产 | - | ip/net| ip/port/service | AssetHost/AssetService | 网段用AssetNetwork.cidr表示，主机归一到AssetHost，服务归一到AssetService |
| 网络应用(非Web) | service | ip/domain | ip/port/service | AssetHost/AssetService | 非Web应用，用cpe/fingerprint定义指纹 |
| Web应用 | web | ip/domain | web_endpoint | AssetWeb | 包含url/tech_stack/status等信息 |
| 业务应用 | other | ip/domain | service | AssetService | 跨服务的业务应用，归一到AssetService |
| 域名资产 | domain | domain | domain | AssetWeb | host_id可选用于映射解析归属 |
| 容器资产 | container | - | container | AssetService/AssetHost | 通过fingerprint/tags标注容器维度，最终归一到服务和主机 |
| 数据库资产 | database | ip/domain | database | AssetService | 使用cpe/fingerprint定义指纹 |
| API资产 | api | api | web_endpoint | AssetWeb | 在attributes.endpoints表示API端点，技术栈可含openapi/rest/graphql等 |

## 详细说明

### IP/网段资产
- **编排输入**：网段用 AssetNetwork.cidr 表示
- **阶段结果**：目标类型为 ip，探活/端口等由 result_type 区分
- **最终实体**：主机归一到 AssetHost，服务归一到 AssetService

### 应用资产
- **网络应用**(非Web)：归一到 AssetService，用 asset_type=service 表示资产类型，cpe/fingerprint 定义指纹
- **Web应用**：归一到 AssetWeb，用 asset_type=web 表示资产类型，用 url/tech_stack/status 表示端点与技术栈
- **跨服务的"业务应用"**：归一到 AssetService，用 asset_type=other 表示资产类型。业务系统虽然为更高级别的概念，但它们在扫描过程中可以表现为域名或IP地址（或其列表）作为扫描目标，并且在扫描完成后会生成服务识别信息作为结果

### 域名资产
- **阶段结果**：目标类型为 target_type=domain
- **最终实体**：通常体现在 AssetWeb.domain，host_id 可选用于映射解析归属

### 容器资产
- **说明**：不单独新建 AssetContainer，除非报告/查询确实需要一类实体；当前设计用指纹+关系即可体现
- **阶段结果**：由 StageResult.attributes 承载容器/编排信息（如 Docker/K8s 指纹）

### 数据库资产
- **阶段识别**：StageResult.result_type=database

### API资产
- **阶段结果**：result_type=web_endpoint，在 attributes.endpoints 表示 API 端点，技术栈可含 openapi/rest/graphql 等
- **最终实体**：归一到 AssetWeb，用 url/tech_stack/status 表示接口端点和框架