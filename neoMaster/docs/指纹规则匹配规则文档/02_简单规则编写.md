# 简单规则编写指南

本文档将教您如何编写简单的指纹规则，适合刚开始使用 NeoScan 指纹识别系统的用户。

## 什么是简单规则？

简单规则是指使用预定义字段（如 `status_code`、`title`、`header` 等）来定义匹配条件的指纹规则。这种方式简单直观，不需要了解复杂的语法。

## 基本规则结构

一个最基本的指纹规则包含以下字段：

```json
{
  "name": "指纹名称",
  "enabled": true
}
```

### 必填字段

| 字段名 | 类型 | 说明 | 示例 |
|-------|------|------|------|
| `name` | string | 指纹名称 | "WordPress" |

### 可选字段

| 字段名 | 类型 | 说明 | 示例 |
|-------|------|------|------|
| `enabled` | boolean | 是否启用 | `true` |
| `source` | string | 来源标识 | "system" 或 "custom" |

## 常用匹配字段

### 1. status_code - HTTP 状态码

匹配 HTTP 响应的状态码。

#### 示例

```json
{
  "name": "WordPress",
  "status_code": "200"
}
```

**说明**：只有当 HTTP 状态码为 200 时，才匹配成功。

**适用场景**：
- 识别正常响应的页面
- 区分正常页面和错误页面

**注意**：
- `status_code` 使用精确匹配（equals）
- 状态码是字符串类型，需要加引号

### 2. title - 网页标题

匹配网页的标题（从 HTML 的 `<title>` 标签提取）。

#### 示例

```json
{
  "name": "WordPress",
  "title": "Log In"
}
```

**说明**：只有当网页标题包含 "Log In" 时，才匹配成功。

**适用场景**：
- 识别特定的登录页面
- 识别特定的应用页面
- 识别特定的错误页面

**注意**：
- `title` 使用包含匹配（contains）
- 默认忽略大小写
- 标题是从 HTML 中自动提取的

#### 更多示例

```json
{
  "name": "WordPress",
  "title": "WordPress › Log In"
}
```

```json
{
  "name": "Joomla",
  "title": "Joomla! Administration Login"
}
```

```json
{
  "name": "Drupal",
  "title": "Log in | Drupal"
}
```

### 3. header - HTTP 响应头

匹配任意 HTTP 响应头的内容。

#### 示例

```json
{
  "name": "Nginx",
  "header": "nginx"
}
```

**说明**：只有当任意 HTTP 响应头包含 "nginx" 时，才匹配成功。

**适用场景**：
- 识别 Web 服务器类型
- 识别特定的中间件
- 识别特定的框架

**注意**：
- `header` 使用包含匹配（contains）
- 默认忽略大小写
- 会检查所有响应头

#### 更多示例

```json
{
  "name": "Apache",
  "header": "Apache"
}
```

```json
{
  "name": "IIS",
  "header": "IIS"
}
```

```json
{
  "name": "Cloudflare",
  "header": "cloudflare"
}
```

### 4. server - Server 响应头

专门匹配 `Server` 响应头的内容。

#### 示例

```json
{
  "name": "Nginx",
  "server": "nginx"
}
```

**说明**：只有当 `Server` 响应头包含 "nginx" 时，才匹配成功。

**适用场景**：
- 识别 Web 服务器类型
- 识别服务器版本

**注意**：
- `server` 使用包含匹配（contains）
- 默认忽略大小写
- 只检查 `Server` 响应头

#### 更多示例

```json
{
  "name": "Apache",
  "server": "Apache"
}
```

```json
{
  "name": "Apache Tomcat",
  "server": "Tomcat"
}
```

```json
{
  "name": "Jetty",
  "server": "Jetty"
}
```

### 5. x_powered_by - X-Powered-By 响应头

专门匹配 `X-Powered-By` 响应头的内容。

#### 示例

```json
{
  "name": "PHP",
  "x_powered_by": "PHP"
}
```

**说明**：只有当 `X-Powered-By` 响应头包含 "PHP" 时，才匹配成功。

**适用场景**：
- 识别后端编程语言
- 识别应用框架

**注意**：
- `x_powered_by` 使用包含匹配（contains）
- 默认忽略大小写
- 只检查 `X-Powered-By` 响应头

#### 更多示例

```json
{
  "name": "ASP.NET",
  "x_powered_by": "ASP.NET"
}
```

```json
{
  "name": "Express",
  "x_powered_by": "Express"
}
```

```json
{
  "name": "ASP.NET Core",
  "x_powered_by": "ASP.NET Core"
}
```

### 6. body - HTTP 响应体

匹配 HTTP 响应体的内容。

#### 示例

```json
{
  "name": "WordPress",
  "body": "wp-content"
}
```

**说明**：只有当 HTTP 响应体包含 "wp-content" 时，才匹配成功。

**适用场景**：
- 识别特定的应用特征
- 识别特定的框架
- 识别特定的 CMS

**注意**：
- `body` 使用包含匹配（contains）
- 默认忽略大小写
- 会检查整个响应体

#### 更多示例

```json
{
  "name": "WordPress",
  "body": "wp-includes"
}
```

```json
{
  "name": "Joomla",
  "body": "joomla"
}
```

```json
{
  "name": "Drupal",
  "body": "drupal"
}
```

### 7. response - HTTP 响应内容

与 `body` 相同，匹配 HTTP 响应体的内容。

#### 示例

```json
{
  "name": "WordPress",
  "response": "wp-content"
}
```

**说明**：与 `body` 字段功能相同。

### 8. footer - HTTP 响应体页脚

匹配 HTTP 响应体页脚的内容。

#### 示例

```json
{
  "name": "WordPress",
  "footer": "Powered by WordPress"
}
```

**说明**：只有当 HTTP 响应体页脚包含 "Powered by WordPress" 时，才匹配成功。

**适用场景**：
- 识别页脚中的版权信息
- 识别特定的应用

**注意**：
- `footer` 使用包含匹配（contains）
- 默认忽略大小写
- 通常用于匹配页脚中的版权信息

### 9. subtitle - HTTP 响应体副标题

匹配 HTTP 响应体副标题的内容。

#### 示例

```json
{
  "name": "WordPress",
  "subtitle": "WordPress"
}
```

**说明**：只有当 HTTP 响应体副标题包含 "WordPress" 时，才匹配成功。

**适用场景**：
- 识别副标题中的信息
- 识别特定的应用

**注意**：
- `subtitle` 使用包含匹配（contains）
- 默认忽略大小写

## 组合多个条件

您可以在一个规则中组合多个条件，所有条件都必须满足（AND 逻辑）。

### 示例1：匹配状态码和标题

```json
{
  "name": "WordPress",
  "status_code": "200",
  "title": "Log In"
}
```

**说明**：只有当 HTTP 状态码为 200 且网页标题包含 "Log In" 时，才匹配成功。

### 示例2：匹配标题和响应体

```json
{
  "name": "WordPress",
  "title": "Log In",
  "body": "wp-content"
}
```

**说明**：只有当网页标题包含 "Log In" 且响应体包含 "wp-content" 时，才匹配成功。

### 示例3：匹配多个响应头

```json
{
  "name": "PHP Nginx",
  "server": "nginx",
  "x_powered_by": "PHP"
}
```

**说明**：只有当 `Server` 响应头包含 "nginx" 且 `X-Powered-By` 响应头包含 "PHP" 时，才匹配成功。

### 示例4：完整示例

```json
{
  "name": "WordPress",
  "status_code": "200",
  "title": "Log In",
  "server": "nginx",
  "body": "wp-content",
  "enabled": true,
  "source": "custom"
}
```

**说明**：只有当以下所有条件都满足时，才匹配成功：
- HTTP 状态码为 200
- 网页标题包含 "Log In"
- `Server` 响应头包含 "nginx"
- 响应体包含 "wp-content"

## 实战示例

### 示例1：识别 WordPress

```json
{
  "name": "WordPress",
  "title": "Log In",
  "body": "wp-content",
  "enabled": true,
  "source": "custom"
}
```

**特征分析**：
- WordPress 登录页标题通常包含 "Log In"
- WordPress 网站通常包含 "wp-content" 目录

### 示例2：识别 Joomla

```json
{
  "name": "Joomla",
  "title": "Joomla! Administration Login",
  "body": "joomla",
  "enabled": true,
  "source": "custom"
}
```

**特征分析**：
- Joomla 管理员登录页标题为 "Joomla! Administration Login"
- Joomla 网站通常包含 "joomla" 关键字

### 示例3：识别 Drupal

```json
{
  "name": "Drupal",
  "title": "Log in | Drupal",
  "body": "drupal",
  "enabled": true,
  "source": "custom"
}
```

**特征分析**：
- Drupal 登录页标题通常包含 "Log in | Drupal"
- Drupal 网站通常包含 "drupal" 关键字

### 示例4：识别 Nginx 服务器

```json
{
  "name": "Nginx",
  "server": "nginx",
  "enabled": true,
  "source": "custom"
}
```

**特征分析**：
- Nginx 服务器的 `Server` 响应头通常包含 "nginx"

### 示例5：识别 Apache 服务器

```json
{
  "name": "Apache",
  "server": "Apache",
  "enabled": true,
  "source": "custom"
}
```

**特征分析**：
- Apache 服务器的 `Server` 响应头通常包含 "Apache"

### 示例6：识别 PHP 应用

```json
{
  "name": "PHP",
  "x_powered_by": "PHP",
  "enabled": true,
  "source": "custom"
}
```

**特征分析**：
- PHP 应用的 `X-Powered-By` 响应头通常包含 "PHP"

### 示例7：识别 ASP.NET 应用

```json
{
  "name": "ASP.NET",
  "x_powered_by": "ASP.NET",
  "enabled": true,
  "source": "custom"
}
```

**特征分析**：
- ASP.NET 应用的 `X-Powered-By` 响应头通常包含 "ASP.NET"

## 常见问题

### Q: 如何确定要匹配什么特征？

A: 您可以通过以下方式确定特征：
1. 访问目标网站，查看页面源代码
2. 使用浏览器开发者工具查看 HTTP 响应
3. 使用 curl 或其他工具查看 HTTP 响应
4. 查看应用的官方文档

### Q: 多个条件之间是什么关系？

A: 多个条件之间是 AND 关系，所有条件都必须满足才能匹配成功。

### Q: 如何区分大小写？

A: 简单字段的匹配默认忽略大小写，不需要额外配置。

### Q: 可以使用通配符吗？

A: 简单字段不支持通配符，如果需要使用通配符，请使用 `match` 字段（参见高级规则编写指南）。

### Q: 如何测试规则是否生效？

A: 您可以通过以下方式测试：
1. 使用系统的指纹识别 API 进行测试
2. 在 Web 界面中手动触发指纹识别
3. 查看日志输出，了解匹配过程

## 最佳实践

1. **选择独特的特征**：选择应用独有的特征，避免误报
2. **组合多个条件**：组合多个条件可以提高准确性
3. **测试规则**：编写规则后，务必进行测试
4. **查看日志**：查看日志了解匹配过程，帮助调试
5. **参考示例**：参考常见示例章节，学习如何编写规则

## 下一步

- 🚀 [高级规则编写指南](./03_高级规则编写.md) - 学习如何使用 match 字段编写高级规则
- 📚 [规则字段详解](./04_规则字段详解.md) - 查看所有可用字段的详细说明
- 💡 [常见示例](./05_常见示例.md) - 查看更多常见应用的指纹规则示例
