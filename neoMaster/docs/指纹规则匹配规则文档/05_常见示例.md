# 常见示例

本文档提供了常见应用、服务、框架的指纹规则示例，供您参考和使用。

## 内容管理（CMS）

### WordPress

**特征**：
- 登录页标题包含 "Log In"
- 响应体包含 "wp-content" 或 "wp-includes"
- 响应体包含 "wp-" 开头的资源

**简单规则**：
```json
{
  "name": "WordPress",
  "status_code": "200",
  "title": "Log In",
  "body": "wp-content",
  "enabled": true,
  "source": "custom"
}
```

**高级规则**：
```json
{
  "name": "WordPress",
  "match": {
    "and": [
      {"field": "status_code", "operator": "equals", "value": "200"},
      {"field": "title", "operator": "contains", "value": "Log In"},
      {
        "or": [
          {"field": "body", "operator": "contains", "value": "wp-content"},
          {"field": "body", "operator": "contains", "value": "wp-includes"}
        ]
      }
    ]
  },
  "enabled": true,
  "source": "custom"
}
```

**正则规则**：
```json
{
  "name": "WordPress",
  "match": "wp-.*",
  "enabled": true,
  "source": "custom"
}
```

### Joomla

**特征**：
- 管理员登录页标题为 "Joomla! Administration Login"
- 响应体包含 "joomla" 关键字

**简单规则**：
```json
{
  "name": "Joomla",
  "title": "Joomla! Administration Login",
  "body": "joomla",
  "enabled": true,
  "source": "custom"
}
```

### Drupal

**特征**：
- 登录页标题包含 "Log in | Drupal"
- 响应体包含 "drupal" 关键字

**简单规则**：
```json
{
  "name": "Drupal",
  "title": "Log in | Drupal",
  "body": "drupal",
  "enabled": true,
  "source": "custom"
}
```

### DedeCMS

**特征**：
- 登录页标题包含 "DedeCMS"
- 响应体包含 "dedecms" 关键字

**简单规则**：
```json
{
  "name": "DedeCMS",
  "title": "DedeCMS",
  "body": "dedecms",
  "enabled": true,
  "source": "custom"
}
```

## Web 服务器

### Nginx

**特征**：
- Server 响应头包含 "nginx"

**简单规则**：
```json
{
  "name": "Nginx",
  "server": "nginx",
  "enabled": true,
  "source": "custom"
}
```

**高级规则**：
```json
{
  "name": "Nginx",
  "match": {
    "field": "server",
    "operator": "regex",
    "value": "nginx/\\d+\\.\\d+\\.\\d+"
  },
  "enabled": true,
  "source": "custom"
}
```

### Apache

**特征**：
- Server 响应头包含 "Apache"

**简单规则**：
```json
{
  "name": "Apache",
  "server": "Apache",
  "enabled": true,
  "source": "custom"
}
```

**高级规则**：
```json
{
  "name": "Apache",
  "match": {
    "field": "server",
    "operator": "regex",
    "value": "Apache/\\d+\\.\\d+\\.\\d+"
  },
  "enabled": true,
  "source": "custom"
}
```

### IIS

**特征**：
- Server 响应头包含 "IIS"

**简单规则**：
```json
{
  "name": "IIS",
  "server": "IIS",
  "enabled": true,
  "source": "custom"
}
```

### Jetty

**特征**：
- Server 响应头包含 "Jetty"

**简单规则**：
```json
{
  "name": "Jetty",
  "server": "Jetty",
  "enabled": true,
  "source": "custom"
}
```

## 编程语言

### PHP

**特征**：
- X-Powered-By 响应头包含 "PHP"

**简单规则**：
```json
{
  "name": "PHP",
  "x_powered_by": "PHP",
  "enabled": true,
  "source": "custom"
}
```

### ASP.NET

**特征**：
- X-Powered-By 响应头包含 "ASP.NET"

**简单规则**：
```json
{
  "name": "ASP.NET",
  "x_powered_by": "ASP.NET",
  "enabled": true,
  "source": "custom"
}
```

### ASP.NET Core

**特征**：
- X-Powered-By 响应头包含 "ASP.NET Core"

**简单规则**：
```json
{
  "name": "ASP.NET Core",
  "x_powered_by": "ASP.NET Core",
  "enabled": true,
  "source": "custom"
}
```

### Python

**特征**：
- X-Powered-By 响应头包含 "Python"
- Server 响应头包含 "Python"

**简单规则**：
```json
{
  "name": "Python",
  "x_powered_by": "Python",
  "enabled": true,
  "source": "custom"
}
```

## Web 框架

### Spring Boot

**特征**：
- 响应体包含 Spring Boot Actuator 端点
- 响应体包含 "Whitelabel Error Page"

**简单规则**：
```json
{
  "name": "Spring Boot",
  "body": "Whitelabel Error Page",
  "enabled": true,
  "source": "custom"
}
```

**高级规则**：
```json
{
  "name": "Spring Boot",
  "match": {
    "or": [
      {"field": "body", "operator": "contains", "value": "Whitelabel Error Page"},
      {"field": "body", "operator": "contains", "value": "Spring Boot"}
    ]
  },
  "enabled": true,
  "source": "custom"
}
```

### Django

**特征**：
- 响应体包含 "Django"
- 响应体包含 "csrfmiddlewaretoken"

**简单规则**：
```json
{
  "name": "Django",
  "body": "Django",
  "enabled": true,
  "source": "custom"
}
```

### Flask

**特征**：
- 响应体包含 "Flask"
- X-Powered-By 响应头包含 "Flask"

**简单规则**：
```json
{
  "name": "Flask",
  "x_powered_by": "Flask",
  "enabled": true,
  "source": "custom"
}
```

### Express

**特征**：
- X-Powered-By 响应头包含 "Express"

**简单规则**：
```json
{
  "name": "Express",
  "x_powered_by": "Express",
  "enabled": true,
  "source": "custom"
}
```

## 中间件

### Cloudflare

**特征**：
- 响应头包含 "cloudflare"
- Server 响应头包含 "cloudflare"

**简单规则**：
```json
{
  "name": "Cloudflare",
  "header": "cloudflare",
  "enabled": true,
  "source": "custom"
}
```

### Nginx反向代理

**特征**：
- Server 响应头包含 "nginx"
- 响应体包含 "nginx"

**简单规则**：
```json
{
  "name": "Nginx Reverse Proxy",
  "server": "nginx",
  "body": "nginx",
  "enabled": true,
  "source": "custom"
}
```

## 电商系统

### Magento

**特征**：
- 登录页标题包含 "Magento"
- 响应体包含 "magento" 关键字

**简单规则**：
```json
{
  "name": "Magento",
  "title": "Magento",
  "body": "magento",
  "enabled": true,
  "source": "custom"
}
```

### Shopify

**特征**：
- 响应体包含 "Shopify"
- 响应体包含 "cdn.shopify.com"

**简单规则**：
```json
{
  "name": "Shopify",
  "body": "Shopify",
  "enabled": true,
  "source": "custom"
}
```

## 论坛系统

### Discuz!

**特征**：
- 登录页标题包含 "Discuz!"
- 响应体包含 "discuz" 关键字

**简单规则**：
```json
{
  "name": "Discuz!",
  "title": "Discuz!",
  "body": "discuz",
  "enabled": true,
  "source": "custom"
}
```

### phpBB

**特征**：
- 登录页标题包含 "phpBB"
- 响应体包含 "phpbb" 关键字

**简单规则**：
```json
{
  "name": "phpBB",
  "title": "phpBB",
  "body": "phpbb",
  "enabled": true,
  "source": "custom"
}
```

## 博客系统

### Typecho

**特征**：
- 登录页标题包含 "Typecho"
- 响应体包含 "typecho" 关键字

**简单规则**：
```json
{
  "name": "Typecho",
  "title": "Typecho",
  "body": "typecho",
  "enabled": true,
  "source": "custom"
}
```

### Hexo

**特征**：
- 响应体包含 "Hexo"
- 响应体包含 "hexo-theme"

**简单规则**：
```json
{
  "name": "Hexo",
  "body": "Hexo",
  "enabled": true,
  "source": "custom"
}
```

## API 网关

### Kong

**特征**：
- 响应头包含 "Kong"
- Server 响应头包含 "kong"

**简单规则**：
```json
{
  "name": "Kong",
  "header": "Kong",
  "enabled": true,
  "source": "custom"
}
```

### Nginx API Gateway

**特征**：
- Server 响应头包含 "nginx"
- 响应体包含 "api" 关键字

**简单规则**：
```json
{
  "name": "Nginx API Gateway",
  "server": "nginx",
  "body": "api",
  "enabled": true,
  "source": "custom"
}
```

## 监控系统

### Zabbix

**特征**：
- 登录页标题包含 "Zabbix"
- 响应体包含 "zabbix" 关键字

**简单规则**：
```json
{
  "name": "Zabbix",
  "title": "Zabbix",
  "body": "zabbix",
  "enabled": true,
  "source": "custom"
}
```

### Prometheus

**特征**：
- 响应体包含 "Prometheus"
- 响应体包含 "prometheus" 关键字

**简单规则**：
```json
{
  "name": "Prometheus",
  "body": "Prometheus",
  "enabled": true,
  "source": "custom"
}
```

## 容器编排

### Kubernetes Dashboard

**特征**：
- 登录页标题包含 "Kubernetes"
- 响应体包含 "kubernetes" 关键字

**简单规则**：
```json
{
  "name": "Kubernetes Dashboard",
  "title": "Kubernetes",
  "body": "kubernetes",
  "enabled": true,
  "source": "custom"
}
```

### Docker Registry

**特征**：
- 响应体包含 "Docker Registry"
- 响应体包含 "docker" 关键字

**简单规则**：
```json
{
  "name": "Docker Registry",
  "body": "Docker Registry",
  "enabled": true,
  "source": "custom"
}
```

## 版本识别

### WordPress 版本识别

**特征**：
- 响应体包含 WordPress 版本号

**高级规则**：
```json
{
  "name": "WordPress Version",
  "match": {
    "field": "all_response",
    "operator": "regex",
    "value": "WordPress\\s+(\\d+\\.\\d+\\.\\d+)"
  },
  "enabled": true,
  "source": "custom"
}
```

### Nginx 版本识别

**特征**：
- Server 响应头包含 Nginx 版本号

**高级规则**：
```json
{
  "name": "Nginx Version",
  "match": {
    "field": "server",
    "operator": "regex",
    "value": "nginx/(\\d+\\.\\d+\\.\\d+)"
  },
  "enabled": true,
  "source": "custom"
}
```

### PHP 版本识别

**特征**：
- X-Powered-By 响应头包含 PHP 版本号

**高级规则**：
```json
{
  "name": "PHP Version",
  "match": {
    "field": "x_powered_by",
    "operator": "regex",
    "value": "PHP/(\\d+\\.\\d+\\.\\d+)"
  },
  "enabled": true,
  "source": "custom"
}
```

## 组合示例

### WordPress + Nginx + PHP

**特征**：
- WordPress CMS
- Nginx Web 服务器
- PHP 编程语言

**高级规则**：
```json
{
  "name": "WordPress on Nginx with PHP",
  "match": {
    "and": [
      {"field": "title", "operator": "contains", "value": "Log In"},
      {"field": "body", "operator": "contains", "value": "wp-content"},
      {"field": "server", "operator": "contains", "value": "nginx"},
      {"field": "x_powered_by", "operator": "contains", "value": "PHP"}
    ]
  },
  "enabled": true,
  "source": "custom"
}
```

### Spring Boot + Nginx + Java

**特征**：
- Spring Boot 框架
- Nginx Web 服务器
- Java 编程语言

**高级规则**：
```json
{
  "name": "Spring Boot on Nginx with Java",
  "match": {
    "and": [
      {"field": "body", "operator": "contains", "value": "Whitelabel Error Page"},
      {"field": "server", "operator": "contains", "value": "nginx"},
      {"field": "x_powered_by", "operator": "contains", "value": "Java"}
    ]
  },
  "enabled": true,
  "source": "custom"
}
```

## 自定义示例

### 识别自定义应用

假设您有一个自定义应用，特征如下：
- 登录页标题为 "MyApp Login"
- 响应体包含 "myapp" 关键字
- 使用 Nginx 服务器

**简单规则**：
```json
{
  "name": "MyApp",
  "title": "MyApp Login",
  "body": "myapp",
  "server": "nginx",
  "enabled": true,
  "source": "custom"
}
```

### 识别特定页面

假设您想识别某个特定的错误页面：
- 状态码为 404
- 标题包含 "Not Found"
- 响应体包含 "404"

**高级规则**：
```json
{
  "name": "Custom 404 Page",
  "match": {
    "and": [
      {"field": "status_code", "operator": "equals", "value": "404"},
      {"field": "title", "operator": "contains", "value": "Not Found"},
      {"field": "body", "operator": "contains", "value": "404"}
    ]
  },
  "enabled": true,
  "source": "custom"
}
```

## 常见问题

### Q: 如何确定应用的特征？

A: 您可以通过以下方式确定特征：
1. 访问目标网站，查看页面源代码
2. 使用浏览器开发者工具查看 HTTP 响应
3. 使用 curl 或其他工具查看 HTTP 响应
4. 查看应用的官方文档

### Q: 如何提高识别的准确性？

A: 您可以通过以下方式提高准确性：
1. 组合多个条件
2. 选择独特的特征
3. 使用正则表达式匹配版本号
4. 测试规则并调整

### Q: 如何避免误报？

A: 您可以通过以下方式避免误报：
1. 选择应用独有的特征
2. 组合多个条件
3. 使用更精确的匹配方式
4. 测试规则并调整

## 下一步

- ✨ [最佳实践](./06_最佳实践.md) - 学习编写高质量规则的最佳实践
