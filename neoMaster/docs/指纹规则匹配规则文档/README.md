# 指纹规则学习文档

欢迎使用 NeoScan 指纹规则学习文档！本系列文档将帮助您快速掌握指纹规则的编写和使用。

## 文档导航

### 📚 学习路径

我们建议按照以下顺序学习：

1. **[快速开始](./00_快速开始.md)** ⭐ 推荐从这里开始
   - 了解什么是指纹规则
   - 学习指纹匹配的基本原理
   - 掌握两种规则编写方式
   - 快速上手编写第一条规则

2. **[指纹匹配原理](./01_指纹匹配原理.md)**
   - 深入了解系统架构
   - 学习指纹匹配的完整流程
   - 理解数据转换机制
   - 掌握规则编译过程

3. **[简单规则编写](./02_简单规则编写.md)**
   - 学习简单字段的使用
   - 掌握常用匹配字段
   - 编写第一条简单规则
   - 了解组合多个条件

4. **[高级规则编写](./03_高级规则编写.md)**
   - 学习 match 字段的使用
   - 掌握所有操作符
   - 理解逻辑组合（AND/OR）
   - 编写复杂的高级规则

5. **[规则字段详解](./04_规则字段详解.md)**
   - 查看所有可用字段的详细说明
   - 了解每个字段的匹配逻辑
   - 掌握操作符的使用方法
   - 参考字段使用建议

6. **[常见示例](./05_常见示例.md)**
   - 查看常见应用的指纹规则示例
   - 学习如何识别不同类型的应用
   - 参考组合示例
   - 获取自定义规则灵感

7. **[最佳实践](./06_最佳实践.md)**
   - 学习编写高质量规则的最佳实践
   - 掌握规则设计原则
   - 了解性能优化技巧
   - 避免常见错误

8. **[服务器指纹识别原理](./07_服务器指纹识别原理.md)**
   - 了解服务器指纹识别的工作原理
   - 学习 Banner 信息分析
   - 掌握 CPE 规则编写
   - 理解正则表达式匹配机制

9. **[Web 指纹 vs 服务器指纹对比](./08_Web指纹_vs_服务器指纹对比.md)**
   - 了解两种指纹的区别和联系
   - 掌握服务器指纹的编写方法
   - 学习两种指纹的使用场景
   - 理解匹配结果的差异

## 快速参考

### 我应该从哪里开始？

| 您的情况 | 建议文档 |
|---------|---------|
| 我是新手，第一次使用 | [快速开始](./00_快速开始.md) |
| 我想了解系统如何工作 | [指纹匹配原理](./01_指纹匹配原理.md) |
| 我想编写简单规则 | [简单规则编写](./02_简单规则编写.md) |
| 我想编写复杂规则 | [高级规则编写](./03_高级规则编写.md) |
| 我想查看所有字段 | [规则字段详解](./04_规则字段详解.md) |
| 我想找示例 | [常见示例](./05_常见示例.md) |
| 我想提高规则质量 | [最佳实践](./06_最佳实践.md) |
| 我想了解服务器指纹 | [服务器指纹识别原理](./07_服务器指纹识别原理.md) |
| 我想了解两种指纹的区别 | [Web 指纹 vs 服务器指纹对比](./08_Web指纹_vs_服务器指纹对比.md) |

### 常见任务

| 任务 | 相关文档 |
|------|---------|
| 编写第一条规则 | [快速开始](./00_快速开始.md) |
| 识别 WordPress | [常见示例](./05_常见示例.md) |
| 识别 Web 服务器 | [常见示例](./05_常见示例.md) |
| 使用正则表达式 | [高级规则编写](./03_高级规则编写.md) |
| 组合多个条件 | [简单规则编写](./02_简单规则编写.md) |
| 优化规则性能 | [最佳实践](./06_最佳实践.md) |
| 调试规则 | [最佳实践](./06_最佳实践.md) |
| 识别 Nginx 服务器 | [服务器指纹识别原理](./07_服务器指纹识别原理.md) |
| 识别 OpenSSH | [服务器指纹识别原理](./07_服务器指纹识别原理.md) |
| 编写 CPE 规则 | [服务器指纹识别原理](./07_服务器指纹识别原理.md) |
| 了解两种指纹的区别 | [Web 指纹 vs 服务器指纹对比](./08_Web指纹_vs_服务器指纹对比.md) |
| 选择合适的指纹类型 | [Web 指纹 vs 服务器指纹对比](./08_Web指纹_vs_服务器指纹对比.md) |
| 编写服务器指纹规则 | [Web 指纹 vs 服务器指纹对比](./08_Web指纹_vs_服务器指纹对比.md) |

## 文档概览

### 00_快速开始.md

**目标**：帮助您在 5 分钟内了解如何编写指纹规则

**内容**：
- 什么是指纹规则
- 指纹匹配的基本原理
- 两种规则编写方式
- 常用字段快速参考
- match 字段快速参考
- 常见问题解答

**适合人群**：新手用户

**预计阅读时间**：5 分钟

### 01_指纹匹配原理.md

**目标**：深入理解指纹识别系统的工作原理

**内容**：
- 系统架构概览
- 指纹匹配的完整流程
- 数据转换详解
- 规则编译详解
- 匹配逻辑详解
- 操作符详解
- 为什么只需要定义"识别什么"

**适合人群**：想深入了解系统的用户

**预计阅读时间**：15 分钟

### 02_简单规则编写.md

**目标**：学习如何编写简单的指纹规则

**内容**：
- 基本规则结构
- 常用匹配字段详解
  - status_code
  - title
  - header
  - server
  - x_powered_by
  - body
  - response
  - footer
  - subtitle
- 组合多个条件
- 实战示例
- 常见问题解答

**适合人群**：刚开始编写规则的用户

**预计阅读时间**：20 分钟

### 03_高级规则编写.md

**目标**：学习如何使用 match 字段编写高级规则

**内容**：
- match 字段的基本格式
- JSON 规则的基本结构
- 字段名（field）详解
- 操作符（operator）详解
  - 字符串操作符
  - 数值操作符
  - 集合操作符
  - 存在性操作符
  - 网络操作符
- 逻辑组合（AND/OR）
- 嵌套逻辑
- 实战示例
- 混合使用简单字段和 match 字段
- 常见问题解答

**适合人群**：需要复杂匹配逻辑的用户

**预计阅读时间**：30 分钟

### 04_规则字段详解.md

**目标**：查看所有可用字段的详细说明

**内容**：
- 规则字段概览
- 必填字段详解
- 可选字段详解
- 匹配字段详解
- 操作符详解
  - 字符串操作符
  - 数值操作符
  - 集合操作符
  - 存在性操作符
  - 网络操作符
- 字段使用建议
- 常见问题解答

**适合人群**：需要参考所有字段的用户

**预计阅读时间**：25 分钟

### 05_常见示例.md

**目标**：查看常见应用的指纹规则示例

**内容**：
- 内容管理（CMS）
  - WordPress
  - Joomla
  - Drupal
  - DedeCMS
- Web 服务器
  - Nginx
  - Apache
  - IIS
  - Jetty
- 编程语言
  - PHP
  - ASP.NET
  - ASP.NET Core
  - Python
- Web 框架
  - Spring Boot
  - Django
  - Flask
  - Express
- 中间件
  - Cloudflare
  - Nginx反向代理
- 电商系统
  - Magento
  - Shopify
- 论坛系统
  - Discuz!
  - phpBB
- 博客系统
  - Typecho
  - Hexo
- API 网关
  - Kong
  - Nginx API Gateway
- 监控系统
  - Zabbix
  - Prometheus
- 容器编排
  - Kubernetes Dashboard
  - Docker Registry
- 版本识别
  - WordPress 版本识别
  - Nginx 版本识别
  - PHP 版本识别
- 组合示例
  - WordPress + Nginx + PHP
  - Spring Boot + Nginx + Java
- 自定义示例
  - 识别自定义应用
  - 识别特定页面

**适合人群**：需要参考示例的用户

**预计阅读时间**：20 分钟

### 06_最佳实践.md

**目标**：学习编写高质量规则的最佳实践

**内容**：
- 规则设计原则
  - 选择独特的特征
  - 组合多个条件
  - 使用精确的匹配方式
  - 避免过度复杂的规则
- 规则编写技巧
  - 从简单开始，逐步完善
  - 使用正则表达式匹配版本号
  - 使用 OR 逻辑处理多种情况
  - 使用嵌套逻辑处理复杂场景
- 性能优化
  - 优先使用简单字段
  - 避免过于复杂的正则表达式
  - 减少不必要的条件
- 可维护性
  - 使用有意义的名称
  - 添加注释
  - 分组相关规则
  - 使用 source 字段标识来源
- 测试和调试
  - 测试规则
  - 查看日志
  - 使用测试工具
- 常见错误
  - 使用过于通用的特征
  - 忽略大小写问题
  - 使用不存在的字段
  - 正则表达式错误
  - 忘记启用规则
- 规则管理
  - 定期审查规则
  - 版本控制
  - 备份规则
  - 文档化规则
- 安全考虑
  - 避免敏感信息
  - 限制规则访问
  - 审计规则变更

**适合人群**：希望提高规则质量的用户

**预计阅读时间**：25 分钟

### 07_服务器指纹识别原理.md

**目标**：了解服务器指纹识别的工作原理

**内容**：
- 服务器指纹识别系统架构
- Banner 信息分析
- CPE 规则格式详解
- 正则表达式匹配机制
- 占位符使用方法
- 常见服务器指纹规则示例
  - Nginx
  - Apache
  - OpenSSH
  - MySQL
  - PostgreSQL
  - Redis
- 服务器指纹 vs Web 指纹对比

**适合人群**：需要识别服务器和服务的用户

**预计阅读时间**：20 分钟

### 08_Web指纹_vs_服务器指纹对比.md

**目标**：了解两种指纹的区别和联系

**内容**：
- 核心区别对比
  - 识别对象
  - 输入数据
  - 规则格式
  - 匹配方式
  - 返回结果
- 详细对比
  - 输入数据对比
  - 规则格式对比
  - 匹配方式对比
  - 返回结果对比
  - 占位符机制对比
- 使用场景
  - Web 指纹适用场景
  - 服务器指纹适用场景
- 服务器指纹编写指南
  - 规则文件格式
  - 规则字段说明
  - CPE 组件类型
  - CPE 格式说明
  - 正则表达式技巧
  - 占位符使用
- 实际示例
  - 识别 Nginx
  - 识别 OpenSSH
  - 识别 Apache
  - 识别 MySQL
- 最佳实践
  - 规则设计原则
  - 规则编写技巧
  - 常见错误
- 总结
  - Web 指纹 vs 服务器指纹对比表
  - 使用建议

**适合人群**：需要了解两种指纹区别和编写服务器指纹规则的用户

**预计阅读时间**：30 分钟

## 学习建议

### 新手用户

1. 阅读 [快速开始](./00_快速开始.md)
2. 尝试编写第一条规则
3. 参考 [常见示例](./05_常见示例.md)
4. 学习 [简单规则编写](./02_简单规则编写.md)

### 进阶用户

1. 阅读 [指纹匹配原理](./01_指纹匹配原理.md)
2. 学习 [高级规则编写](./03_高级规则编写.md)
3. 参考 [规则字段详解](./04_规则字段详解.md)
4. 实践编写复杂规则

### 高级用户

1. 深入理解 [指纹匹配原理](./01_指纹匹配原理.md)
2. 掌握 [高级规则编写](./03_高级规则编写.md)
3. 学习 [最佳实践](./06_最佳实践.md)
4. 优化现有规则

## 获取帮助

如果您在编写指纹规则时遇到问题：

1. **查看文档**：首先查看相关文档章节
2. **查看示例**：参考 [常见示例](./05_常见示例.md)
3. **查看日志**：查看系统日志了解匹配过程
4. **测试规则**：使用测试工具验证规则
5. **联系支持**：联系技术支持获取帮助

## 反馈

如果您对文档有任何建议或发现任何问题，欢迎反馈！

## 更新日志

- **2025-01-10**：初始版本发布
  - 创建 7 个学习文档
  - 覆盖从入门到高级的所有内容
  - 提供丰富的示例和最佳实践

## 许可

本文档遵循 NeoScan 项目的许可证。

---

**开始学习**：[快速开始](./00_快速开始.md) ⭐
