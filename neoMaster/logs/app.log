{"func_name":"setup.auth.BuildAuthModule","level":"info","message":"开始构建认证模块","operation":"setup","option":"setup.auth.begin","path":"internal.app.master.setup.auth.BuildAuthModule","timestamp":"2025-11-04 18:36:17.587"}
{"func_name":"setup.auth.BuildAuthModule","level":"info","message":"会话存储使用 Redis 实现","operation":"setup","option":"setup.auth.repo.session.redis","path":"internal.app.master.setup.auth.BuildAuthModule","timestamp":"2025-11-04 18:36:17.587"}
{"func_name":"setup.auth.BuildAuthModule","level":"info","message":"认证模块构建完成","operation":"setup","option":"setup.auth.done","path":"internal.app.master.setup.auth.BuildAuthModule","timestamp":"2025-11-04 18:36:17.588"}
{"func_name":"setup.rbac.BuildSystemRBACModule","level":"info","message":"开始构建系统RBAC模块","operation":"setup","option":"setup.rbac.begin","path":"internal.app.master.setup.rbac.BuildSystemRBACModule","timestamp":"2025-11-04 18:36:17.588"}
{"func_name":"setup.rbac.BuildSystemRBACModule","level":"info","message":"系统RBAC模块构建完成","operation":"setup","option":"setup.rbac.done","path":"internal.app.master.setup.rbac.BuildSystemRBACModule","timestamp":"2025-11-04 18:36:17.588"}
{"func_name":"router.registerGlobalMiddleware","level":"info","message":"开始注册全局中间件","operation":"register_global_middleware","option":"middlewareManager.attach","path":"router_manager.registerGlobalMiddleware","timestamp":"2025-11-04 18:36:17.589"}
{"func_name":"router.registerGlobalMiddleware","level":"info","message":"全局中间件注册完成","operation":"register_global_middleware","option":"middlewareManager.attach.done","path":"router_manager.registerGlobalMiddleware","timestamp":"2025-11-04 18:36:17.589"}
{"func_name":"router.registerRoutes","level":"info","message":"开始注册路由","operation":"register_routes","option":"routes.attach.begin","path":"router_manager.registerRoutes","timestamp":"2025-11-04 18:36:17.589"}
{"func_name":"router.registerRoutes","level":"info","message":"路由注册完成","operation":"register_routes","option":"routes.attach.done","path":"router_manager.registerRoutes","timestamp":"2025-11-04 18:36:17.589"}
{"client_ip":"127.0.0.5","fields.message":"Processing CORS request","func_name":"middleware.security.GinCORSMiddleware","level":"info","message":"Processing CORS request","method":"POST","operation":"cors_middleware","option":"handle_cors_request","origin":"","path":"/api/v1/auth/login","request_id":"","timestamp":"2025-11-04 18:37:48.865","type":"info","user_id":0}
{"client_ip":"127.0.0.5","fields.message":"Setting security headers","func_name":"middleware.security.GinSecurityHeadersMiddleware","level":"info","message":"Setting security headers","method":"POST","operation":"security_headers","option":"set_security_headers","path":"/api/v1/auth/login","request_id":"","timestamp":"2025-11-04 18:37:48.866","type":"info","user_id":0}
{"client_ip":"9.9.9.0","fields.message":"Processing CORS request","func_name":"middleware.security.GinCORSMiddleware","level":"info","message":"Processing CORS request","method":"GET","operation":"cors_middleware","option":"handle_cors_request","origin":"","path":"/api/v1/admin/users/16/info","request_id":"","timestamp":"2025-11-04 18:38:44.674","type":"info","user_id":0}
{"client_ip":"9.9.9.0","fields.message":"Setting security headers","func_name":"middleware.security.GinSecurityHeadersMiddleware","level":"info","message":"Setting security headers","method":"GET","operation":"security_headers","option":"set_security_headers","path":"/api/v1/admin/users/16/info","request_id":"","timestamp":"2025-11-04 18:38:44.675","type":"info","user_id":0}
{"level":"info","message":"Authentication requestmap[X-Request-ID: client_ip:9.9.9.0 func_name:middleware.auth.GinJWTAuthMiddleware method:GET path:/api/v1/admin/users/16/info user_agent:Apifox/1.0.0 (https://apifox.com)]","timestamp":"2025-11-04 18:38:44.675"}
{"level":"debug","message":"IP not in whitelist map[client_ip:9.9.9.0 func_name:middleware.auth.GinAuthMiddleware]","timestamp":"2025-11-04 18:38:44.675"}
{"client_ip":"9.9.9.0","fields.message":"Processing CORS request","func_name":"middleware.security.GinCORSMiddleware","level":"info","message":"Processing CORS request","method":"GET","operation":"cors_middleware","option":"handle_cors_request","origin":"","path":"/api/v1/admin/users/1/info","request_id":"","timestamp":"2025-11-04 18:38:52.886","type":"info","user_id":0}
{"client_ip":"9.9.9.0","fields.message":"Setting security headers","func_name":"middleware.security.GinSecurityHeadersMiddleware","level":"info","message":"Setting security headers","method":"GET","operation":"security_headers","option":"set_security_headers","path":"/api/v1/admin/users/1/info","request_id":"","timestamp":"2025-11-04 18:38:52.886","type":"info","user_id":0}
{"level":"info","message":"Authentication requestmap[X-Request-ID: client_ip:9.9.9.0 func_name:middleware.auth.GinJWTAuthMiddleware method:GET path:/api/v1/admin/users/1/info user_agent:Apifox/1.0.0 (https://apifox.com)]","timestamp":"2025-11-04 18:38:52.886"}
{"level":"debug","message":"IP not in whitelist map[client_ip:9.9.9.0 func_name:middleware.auth.GinAuthMiddleware]","timestamp":"2025-11-04 18:38:52.887"}
{"client_ip":"127.0.0.4","fields.message":"Processing CORS request","func_name":"middleware.security.GinCORSMiddleware","level":"info","message":"Processing CORS request","method":"POST","operation":"cors_middleware","option":"handle_cors_request","origin":"","path":"/api/v1/auth/register","request_id":"","timestamp":"2025-11-04 18:39:57.368","type":"info","user_id":0}
{"client_ip":"127.0.0.4","fields.message":"Setting security headers","func_name":"middleware.security.GinSecurityHeadersMiddleware","level":"info","message":"Setting security headers","method":"POST","operation":"security_headers","option":"set_security_headers","path":"/api/v1/auth/register","request_id":"","timestamp":"2025-11-04 18:39:57.368","type":"info","user_id":0}
{"client_ip":"127.0.0.4","fields.message":"Processing CORS request","func_name":"middleware.security.GinCORSMiddleware","level":"info","message":"Processing CORS request","method":"POST","operation":"cors_middleware","option":"handle_cors_request","origin":"","path":"/api/v1/auth/register","request_id":"","timestamp":"2025-11-04 18:40:25.094","type":"info","user_id":0}
{"client_ip":"127.0.0.4","fields.message":"Setting security headers","func_name":"middleware.security.GinSecurityHeadersMiddleware","level":"info","message":"Setting security headers","method":"POST","operation":"security_headers","option":"set_security_headers","path":"/api/v1/auth/register","request_id":"","timestamp":"2025-11-04 18:40:25.094","type":"info","user_id":0}
{"client_ip":"3.3.3.3","fields.message":"Processing CORS request","func_name":"middleware.security.GinCORSMiddleware","level":"info","message":"Processing CORS request","method":"POST","operation":"cors_middleware","option":"handle_cors_request","origin":"","path":"/api/v1/admin/users/create","request_id":"","timestamp":"2025-11-04 18:41:28.861","type":"info","user_id":0}
{"client_ip":"3.3.3.3","fields.message":"Setting security headers","func_name":"middleware.security.GinSecurityHeadersMiddleware","level":"info","message":"Setting security headers","method":"POST","operation":"security_headers","option":"set_security_headers","path":"/api/v1/admin/users/create","request_id":"","timestamp":"2025-11-04 18:41:28.861","type":"info","user_id":0}
{"level":"info","message":"Authentication requestmap[X-Request-ID: client_ip:3.3.3.3 func_name:middleware.auth.GinJWTAuthMiddleware method:POST path:/api/v1/admin/users/create user_agent:Apifox/1.0.0 (https://apifox.com)]","timestamp":"2025-11-04 18:41:28.861"}
{"level":"debug","message":"IP not in whitelist map[client_ip:3.3.3.3 func_name:middleware.auth.GinAuthMiddleware]","timestamp":"2025-11-04 18:41:28.861"}
{"client_ip":"::1","fields.message":"Processing CORS request","func_name":"middleware.security.GinCORSMiddleware","level":"info","message":"Processing CORS request","method":"POST","operation":"cors_middleware","option":"handle_cors_request","origin":"","path":"/api/v1/admin/users/5","request_id":"","timestamp":"2025-11-04 18:42:32.570","type":"info","user_id":0}
{"client_ip":"::1","fields.message":"Setting security headers","func_name":"middleware.security.GinSecurityHeadersMiddleware","level":"info","message":"Setting security headers","method":"POST","operation":"security_headers","option":"set_security_headers","path":"/api/v1/admin/users/5","request_id":"","timestamp":"2025-11-04 18:42:32.570","type":"info","user_id":0}
{"level":"info","message":"Authentication requestmap[X-Request-ID: client_ip:::1 func_name:middleware.auth.GinJWTAuthMiddleware method:POST path:/api/v1/admin/users/5 user_agent:Apifox/1.0.0 (https://apifox.com)]","timestamp":"2025-11-04 18:42:32.571"}
{"level":"debug","message":"IP not in whitelist map[client_ip:::1 func_name:middleware.auth.GinAuthMiddleware]","timestamp":"2025-11-04 18:42:32.571"}
{"client_ip":"::1","fields.message":"Processing CORS request","func_name":"middleware.security.GinCORSMiddleware","level":"info","message":"Processing CORS request","method":"POST","operation":"cors_middleware","option":"handle_cors_request","origin":"","path":"/api/v1/admin/users/5/activate","request_id":"","timestamp":"2025-11-04 18:43:37.003","type":"info","user_id":0}
{"client_ip":"::1","fields.message":"Setting security headers","func_name":"middleware.security.GinSecurityHeadersMiddleware","level":"info","message":"Setting security headers","method":"POST","operation":"security_headers","option":"set_security_headers","path":"/api/v1/admin/users/5/activate","request_id":"","timestamp":"2025-11-04 18:43:37.003","type":"info","user_id":0}
{"level":"info","message":"Authentication requestmap[X-Request-ID: client_ip:::1 func_name:middleware.auth.GinJWTAuthMiddleware method:POST path:/api/v1/admin/users/5/activate user_agent:Apifox/1.0.0 (https://apifox.com)]","timestamp":"2025-11-04 18:43:37.003"}
{"level":"debug","message":"IP not in whitelist map[client_ip:::1 func_name:middleware.auth.GinAuthMiddleware]","timestamp":"2025-11-04 18:43:37.003"}
{"client_ip":"::1","fields.message":"Processing CORS request","func_name":"middleware.security.GinCORSMiddleware","level":"info","message":"Processing CORS request","method":"POST","operation":"cors_middleware","option":"handle_cors_request","origin":"","path":"/api/v1/admin/users/5/activate","request_id":"","timestamp":"2025-11-04 18:43:54.369","type":"info","user_id":0}
{"client_ip":"::1","fields.message":"Setting security headers","func_name":"middleware.security.GinSecurityHeadersMiddleware","level":"info","message":"Setting security headers","method":"POST","operation":"security_headers","option":"set_security_headers","path":"/api/v1/admin/users/5/activate","request_id":"","timestamp":"2025-11-04 18:43:54.369","type":"info","user_id":0}
{"level":"info","message":"Authentication requestmap[X-Request-ID: client_ip:::1 func_name:middleware.auth.GinJWTAuthMiddleware method:POST path:/api/v1/admin/users/5/activate user_agent:Apifox/1.0.0 (https://apifox.com)]","timestamp":"2025-11-04 18:43:54.369"}
{"level":"debug","message":"IP not in whitelist map[client_ip:::1 func_name:middleware.auth.GinAuthMiddleware]","timestamp":"2025-11-04 18:43:54.369"}
{"client_ip":"::1","fields.message":"Processing CORS request","func_name":"middleware.security.GinCORSMiddleware","level":"info","message":"Processing CORS request","method":"POST","operation":"cors_middleware","option":"handle_cors_request","origin":"","path":"/api/v1/admin/users/1/reset-password","request_id":"","timestamp":"2025-11-04 18:44:10.601","type":"info","user_id":0}
{"client_ip":"::1","fields.message":"Setting security headers","func_name":"middleware.security.GinSecurityHeadersMiddleware","level":"info","message":"Setting security headers","method":"POST","operation":"security_headers","option":"set_security_headers","path":"/api/v1/admin/users/1/reset-password","request_id":"","timestamp":"2025-11-04 18:44:10.601","type":"info","user_id":0}
{"level":"info","message":"Authentication requestmap[X-Request-ID: client_ip:::1 func_name:middleware.auth.GinJWTAuthMiddleware method:POST path:/api/v1/admin/users/1/reset-password user_agent:Apifox/1.0.0 (https://apifox.com)]","timestamp":"2025-11-04 18:44:10.601"}
{"level":"debug","message":"IP not in whitelist map[client_ip:::1 func_name:middleware.auth.GinAuthMiddleware]","timestamp":"2025-11-04 18:44:10.601"}
{"client_ip":"::1","fields.message":"Processing CORS request","func_name":"middleware.security.GinCORSMiddleware","level":"info","message":"Processing CORS request","method":"POST","operation":"cors_middleware","option":"handle_cors_request","origin":"","path":"/api/v1/admin/users/1/reset-password","request_id":"","timestamp":"2025-11-04 18:44:17.858","type":"info","user_id":0}
{"client_ip":"::1","fields.message":"Setting security headers","func_name":"middleware.security.GinSecurityHeadersMiddleware","level":"info","message":"Setting security headers","method":"POST","operation":"security_headers","option":"set_security_headers","path":"/api/v1/admin/users/1/reset-password","request_id":"","timestamp":"2025-11-04 18:44:17.859","type":"info","user_id":0}
{"level":"info","message":"Authentication requestmap[X-Request-ID: client_ip:::1 func_name:middleware.auth.GinJWTAuthMiddleware method:POST path:/api/v1/admin/users/1/reset-password user_agent:Apifox/1.0.0 (https://apifox.com)]","timestamp":"2025-11-04 18:44:17.859"}
{"level":"debug","message":"IP not in whitelist map[client_ip:::1 func_name:middleware.auth.GinAuthMiddleware]","timestamp":"2025-11-04 18:44:17.859"}
{"client_ip":"127.0.0.5","fields.message":"Processing CORS request","func_name":"middleware.security.GinCORSMiddleware","level":"info","message":"Processing CORS request","method":"POST","operation":"cors_middleware","option":"handle_cors_request","origin":"","path":"/api/v1/auth/login","request_id":"","timestamp":"2025-11-04 18:45:58.521","type":"info","user_id":0}
{"client_ip":"127.0.0.5","fields.message":"Setting security headers","func_name":"middleware.security.GinSecurityHeadersMiddleware","level":"info","message":"Setting security headers","method":"POST","operation":"security_headers","option":"set_security_headers","path":"/api/v1/auth/login","request_id":"","timestamp":"2025-11-04 18:45:58.522","type":"info","user_id":0}
{"client_ip":"127.0.0.5","fields.message":"Processing CORS request","func_name":"middleware.security.GinCORSMiddleware","level":"info","message":"Processing CORS request","method":"POST","operation":"cors_middleware","option":"handle_cors_request","origin":"","path":"/api/v1/auth/login","request_id":"","timestamp":"2025-11-04 18:46:07.894","type":"info","user_id":0}
{"client_ip":"127.0.0.5","fields.message":"Setting security headers","func_name":"middleware.security.GinSecurityHeadersMiddleware","level":"info","message":"Setting security headers","method":"POST","operation":"security_headers","option":"set_security_headers","path":"/api/v1/auth/login","request_id":"","timestamp":"2025-11-04 18:46:07.894","type":"info","user_id":0}
{"client_ip":"::1","fields.message":"Processing CORS request","func_name":"middleware.security.GinCORSMiddleware","level":"info","message":"Processing CORS request","method":"POST","operation":"cors_middleware","option":"handle_cors_request","origin":"","path":"/api/v1/admin/users/1","request_id":"","timestamp":"2025-11-04 18:48:15.053","type":"info","user_id":0}
{"client_ip":"::1","fields.message":"Setting security headers","func_name":"middleware.security.GinSecurityHeadersMiddleware","level":"info","message":"Setting security headers","method":"POST","operation":"security_headers","option":"set_security_headers","path":"/api/v1/admin/users/1","request_id":"","timestamp":"2025-11-04 18:48:15.053","type":"info","user_id":0}
{"level":"info","message":"Authentication requestmap[X-Request-ID: client_ip:::1 func_name:middleware.auth.GinJWTAuthMiddleware method:POST path:/api/v1/admin/users/1 user_agent:Apifox/1.0.0 (https://apifox.com)]","timestamp":"2025-11-04 18:48:15.054"}
{"level":"debug","message":"IP not in whitelist map[client_ip:::1 func_name:middleware.auth.GinAuthMiddleware]","timestamp":"2025-11-04 18:48:15.054"}
{"client_ip":"127.0.0.5","fields.message":"Processing CORS request","func_name":"middleware.security.GinCORSMiddleware","level":"info","message":"Processing CORS request","method":"POST","operation":"cors_middleware","option":"handle_cors_request","origin":"","path":"/api/v1/auth/login","request_id":"","timestamp":"2025-11-04 18:48:27.793","type":"info","user_id":0}
{"client_ip":"127.0.0.5","fields.message":"Setting security headers","func_name":"middleware.security.GinSecurityHeadersMiddleware","level":"info","message":"Setting security headers","method":"POST","operation":"security_headers","option":"set_security_headers","path":"/api/v1/auth/login","request_id":"","timestamp":"2025-11-04 18:48:27.793","type":"info","user_id":0}
{"client_ip":"127.0.0.5","fields.message":"Processing CORS request","func_name":"middleware.security.GinCORSMiddleware","level":"info","message":"Processing CORS request","method":"POST","operation":"cors_middleware","option":"handle_cors_request","origin":"","path":"/api/v1/auth/login","request_id":"","timestamp":"2025-11-04 18:49:03.081","type":"info","user_id":0}
{"level":"debug","message":"IP not in whitelist map[client_ip:6.6.6.6 func_name:middleware.auth.GinAuthMiddleware]","timestamp":"2025-11-04 18:55:45.206"}
{"func_name":"setup.auth.BuildAuthModule","level":"info","message":"开始构建认证模块","operation":"setup","option":"setup.auth.begin","path":"internal.app.master.setup.auth.BuildAuthModule","timestamp":"2025-11-05 14:08:25.674"}
{"func_name":"setup.auth.BuildAuthModule","level":"info","message":"会话存储使用 Redis 实现","operation":"setup","option":"setup.auth.repo.session.redis","path":"internal.app.master.setup.auth.BuildAuthModule","timestamp":"2025-11-05 14:08:25.688"}
{"func_name":"setup.auth.BuildAuthModule","level":"info","message":"认证模块构建完成","operation":"setup","option":"setup.auth.done","path":"internal.app.master.setup.auth.BuildAuthModule","timestamp":"2025-11-05 14:08:25.688"}
{"func_name":"setup.rbac.BuildSystemRBACModule","level":"info","message":"开始构建系统RBAC模块","operation":"setup","option":"setup.rbac.begin","path":"internal.app.master.setup.rbac.BuildSystemRBACModule","timestamp":"2025-11-05 14:08:25.688"}
{"func_name":"setup.rbac.BuildSystemRBACModule","level":"info","message":"系统RBAC模块构建完成","operation":"setup","option":"setup.rbac.done","path":"internal.app.master.setup.rbac.BuildSystemRBACModule","timestamp":"2025-11-05 14:08:25.688"}
{"func_name":"setup.agent.BuildAgentModule","level":"info","message":"开始构建 Agent 管理模块","operation":"setup","option":"setup.agent.begin","path":"internal.app.master.setup.agent.BuildAgentModule","timestamp":"2025-11-05 14:08:25.689"}
{"func_name":"setup.agent.BuildAgentModule","level":"info","message":"Agent 管理模块构建完成","operation":"setup","option":"setup.agent.done","path":"internal.app.master.setup.agent.BuildAgentModule","timestamp":"2025-11-05 14:08:25.689"}
{"func_name":"setup.orchestrator.BuildOrchestratorModule","level":"info","message":"开始构建扫描编排器模块","operation":"setup","option":"setup.orchestrator.begin","path":"internal.app.master.setup.orchestrator.BuildOrchestratorModule","timestamp":"2025-11-05 14:08:25.689"}
{"func_name":"setup.orchestrator.BuildOrchestratorModule","level":"info","message":"扫描编排器模块构建完成","operation":"setup","option":"setup.orchestrator.done","path":"internal.app.master.setup.orchestrator.BuildOrchestratorModule","timestamp":"2025-11-05 14:08:25.689"}
{"func_name":"router.registerGlobalMiddleware","level":"info","message":"开始注册全局中间件","operation":"register_global_middleware","option":"middlewareManager.attach","path":"router_manager.registerGlobalMiddleware","timestamp":"2025-11-05 14:08:25.689"}
{"func_name":"router.registerGlobalMiddleware","level":"info","message":"全局中间件注册完成","operation":"register_global_middleware","option":"middlewareManager.attach.done","path":"router_manager.registerGlobalMiddleware","timestamp":"2025-11-05 14:08:25.689"}
{"func_name":"router.registerRoutes","level":"info","message":"开始注册路由","operation":"register_routes","option":"routes.attach.begin","path":"router_manager.registerRoutes","timestamp":"2025-11-05 14:08:25.689"}
{"func_name":"router.registerRoutes","level":"info","message":"路由注册完成","operation":"register_routes","option":"routes.attach.done","path":"router_manager.registerRoutes","timestamp":"2025-11-05 14:08:25.690"}
{"client_ip":"9.9.9.9","fields.message":"Processing CORS request","func_name":"middleware.security.GinCORSMiddleware","level":"info","message":"Processing CORS request","method":"GET","operation":"cors_middleware","option":"handle_cors_request","origin":"","path":"/api/v1/agent","request_id":"","timestamp":"2025-11-05 14:08:40.676","type":"info","user_id":0}
{"client_ip":"9.9.9.9","fields.message":"Setting security headers","func_name":"middleware.security.GinSecurityHeadersMiddleware","level":"info","message":"Setting security headers","method":"GET","operation":"security_headers","option":"set_security_headers","path":"/api/v1/agent","request_id":"","timestamp":"2025-11-05 14:08:40.677","type":"info","user_id":0}
{"level":"info","message":"Authentication requestmap[X-Request-ID: client_ip:9.9.9.9 func_name:middleware.auth.GinJWTAuthMiddleware method:GET path:/api/v1/agent user_agent:Apifox/1.0.0 (https://apifox.com)]","timestamp":"2025-11-05 14:08:40.678"}
{"level":"info","message":"IP whitelist authentication passed map[client_ip:9.9.9.9 func_name:middleware.auth.GinAuthMiddleware]","timestamp":"2025-11-05 14:08:40.678"}
{"client_ip":"","count":0,"fields.message":"Agent列表获取成功","func_name":"repo.agent.GetList","level":"info","message":"Agent列表获取成功","method":"","operation":"get_agent_list","option":"agentRepository.GetList","path":"repo.agent.GetList","request_id":"","timestamp":"2025-11-05 14:08:41.175","total":0,"type":"info","user_id":0}
{"client_ip":"9.9.9.9","fields.message":"获取Agent列表成功","func_name":"handler.agent.GetAgentList","level":"info","message":"获取Agent列表成功","method":"GET","operation":"get_agent_list","option":"success","path":"/api/v1/agent?page=1\u0026page_size=10\u0026status=offline\u0026keyword=prod-scanner-01\u0026capabilities=","request_id":"","timestamp":"2025-11-05 14:08:41.175","total":0,"type":"info","user_agent":"Apifox/1.0.0 (https://apifox.com)","user_id":0}
{"client_ip":"9.9.9.9","fields.message":"Processing CORS request","func_name":"middleware.security.GinCORSMiddleware","level":"info","message":"Processing CORS request","method":"GET","operation":"cors_middleware","option":"handle_cors_request","origin":"","path":"/api/v1/agent","request_id":"","timestamp":"2025-11-05 14:09:36.707","type":"info","user_id":0}
{"client_ip":"9.9.9.9","fields.message":"Setting security headers","func_name":"middleware.security.GinSecurityHeadersMiddleware","level":"info","message":"Setting security headers","method":"GET","operation":"security_headers","option":"set_security_headers","path":"/api/v1/agent","request_id":"","timestamp":"2025-11-05 14:09:36.707","type":"info","user_id":0}
{"level":"info","message":"Authentication requestmap[X-Request-ID: client_ip:9.9.9.9 func_name:middleware.auth.GinJWTAuthMiddleware method:GET path:/api/v1/agent user_agent:Apifox/1.0.0 (https://apifox.com)]","timestamp":"2025-11-05 14:09:36.707"}
{"level":"info","message":"IP whitelist authentication passed map[client_ip:9.9.9.9 func_name:middleware.auth.GinAuthMiddleware]","timestamp":"2025-11-05 14:09:36.707"}
{"client_ip":"","count":0,"fields.message":"Agent列表获取成功","func_name":"repo.agent.GetList","level":"info","message":"Agent列表获取成功","method":"","operation":"get_agent_list","option":"agentRepository.GetList","path":"repo.agent.GetList","request_id":"","timestamp":"2025-11-05 14:09:36.732","total":0,"type":"info","user_id":0}
{"client_ip":"9.9.9.9","fields.message":"获取Agent列表成功","func_name":"handler.agent.GetAgentList","level":"info","message":"获取Agent列表成功","method":"GET","operation":"get_agent_list","option":"success","path":"/api/v1/agent?page=1\u0026page_size=10\u0026status=offline\u0026keyword=agent\u0026capabilities=","request_id":"","timestamp":"2025-11-05 14:09:36.732","total":0,"type":"info","user_agent":"Apifox/1.0.0 (https://apifox.com)","user_id":0}
{"client_ip":"9.9.9.9","fields.message":"Processing CORS request","func_name":"middleware.security.GinCORSMiddleware","level":"info","message":"Processing CORS request","method":"GET","operation":"cors_middleware","option":"handle_cors_request","origin":"","path":"/api/v1/agent","request_id":"","timestamp":"2025-11-05 14:11:17.641","type":"info","user_id":0}
{"client_ip":"9.9.9.9","fields.message":"Setting security headers","func_name":"middleware.security.GinSecurityHeadersMiddleware","level":"info","message":"Setting security headers","method":"GET","operation":"security_headers","option":"set_security_headers","path":"/api/v1/agent","request_id":"","timestamp":"2025-11-05 14:11:17.641","type":"info","user_id":0}
{"level":"info","message":"Authentication requestmap[X-Request-ID: client_ip:9.9.9.9 func_name:middleware.auth.GinJWTAuthMiddleware method:GET path:/api/v1/agent user_agent:Apifox/1.0.0 (https://apifox.com)]","timestamp":"2025-11-05 14:11:17.641"}
{"level":"info","message":"IP whitelist authentication passed map[client_ip:9.9.9.9 func_name:middleware.auth.GinAuthMiddleware]","timestamp":"2025-11-05 14:11:17.641"}
{"client_ip":"","count":1,"fields.message":"Agent列表获取成功","func_name":"repo.agent.GetList","level":"info","message":"Agent列表获取成功","method":"","operation":"get_agent_list","option":"agentRepository.GetList","path":"repo.agent.GetList","request_id":"","timestamp":"2025-11-05 14:11:17.647","total":1,"type":"info","user_id":0}
{"client_ip":"9.9.9.9","fields.message":"获取Agent列表成功","func_name":"handler.agent.GetAgentList","level":"info","message":"获取Agent列表成功","method":"GET","operation":"get_agent_list","option":"success","path":"/api/v1/agent?page=1\u0026page_size=10\u0026status=online\u0026keyword=scanner-01\u0026tags=7,1\u0026capabilities=1,2,3","request_id":"","timestamp":"2025-11-05 14:11:17.648","total":1,"type":"info","user_agent":"Apifox/1.0.0 (https://apifox.com)","user_id":0}
{"client_ip":"9.9.9.9","fields.message":"Processing CORS request","func_name":"middleware.security.GinCORSMiddleware","level":"info","message":"Processing CORS request","method":"GET","operation":"cors_middleware","option":"handle_cors_request","origin":"","path":"/api/v1/agent","request_id":"","timestamp":"2025-11-05 14:12:11.536","type":"info","user_id":0}
{"client_ip":"9.9.9.9","fields.message":"Setting security headers","func_name":"middleware.security.GinSecurityHeadersMiddleware","level":"info","message":"Setting security headers","method":"GET","operation":"security_headers","option":"set_security_headers","path":"/api/v1/agent","request_id":"","timestamp":"2025-11-05 14:12:11.536","type":"info","user_id":0}
{"level":"info","message":"Authentication requestmap[X-Request-ID: client_ip:9.9.9.9 func_name:middleware.auth.GinJWTAuthMiddleware method:GET path:/api/v1/agent user_agent:Apifox/1.0.0 (https://apifox.com)]","timestamp":"2025-11-05 14:12:11.536"}
{"level":"info","message":"IP whitelist authentication passed map[client_ip:9.9.9.9 func_name:middleware.auth.GinAuthMiddleware]","timestamp":"2025-11-05 14:12:11.537"}
{"client_ip":"","count":8,"fields.message":"Agent列表获取成功","func_name":"repo.agent.GetList","level":"info","message":"Agent列表获取成功","method":"","operation":"get_agent_list","option":"agentRepository.GetList","path":"repo.agent.GetList","request_id":"","timestamp":"2025-11-05 14:12:11.541","total":8,"type":"info","user_id":0}
{"client_ip":"9.9.9.9","fields.message":"获取Agent列表成功","func_name":"handler.agent.GetAgentList","level":"info","message":"获取Agent列表成功","method":"GET","operation":"get_agent_list","option":"success","path":"/api/v1/agent?page=1\u0026page_size=10\u0026status=online","request_id":"","timestamp":"2025-11-05 14:12:11.542","total":8,"type":"info","user_agent":"Apifox/1.0.0 (https://apifox.com)","user_id":0}
{"client_ip":"9.9.9.9","fields.message":"Processing CORS request","func_name":"middleware.security.GinCORSMiddleware","level":"info","message":"Processing CORS request","method":"POST","operation":"cors_middleware","option":"handle_cors_request","origin":"","path":"/api/v1/agent/register","request_id":"","timestamp":"2025-11-05 14:13:32.347","type":"info","user_id":0}
{"client_ip":"9.9.9.9","fields.message":"Setting security headers","func_name":"middleware.security.GinSecurityHeadersMiddleware","level":"info","message":"Setting security headers","method":"POST","operation":"security_headers","option":"set_security_headers","path":"/api/v1/agent/register","request_id":"","timestamp":"2025-11-05 14:13:32.347","type":"info","user_id":0}
{"agent_id":"agent_6fd494fb49834d7ea4b685de50d983b2","client_ip":"","fields.message":"Agent记录创建成功","func_name":"repo.agent.Create","hostname":"test-agent-004","level":"info","message":"Agent记录创建成功","method":"","operation":"create_agent","option":"agentRepository.Create","path":"repo.agent.Create","request_id":"","timestamp":"2025-11-05 14:13:32.750","type":"info","user_id":0}
{"agent_id":"agent_6fd494fb49834d7ea4b685de50d983b2","client_ip":"","fields.message":"Agent注册成功","func_name":"service.agent.manager.RegisterAgent","hostname":"test-agent-004","level":"info","message":"Agent注册成功","method":"","operation":"register_agent","option":"agentManagerService.RegisterAgent","path":"service.agent.manager.RegisterAgent","request_id":"","timestamp":"2025-11-05 14:13:32.750","type":"info","user_id":0}
{"agent_id":"agent_6fd494fb49834d7ea4b685de50d983b2","client_ip":"9.9.9.9","fields.message":"Agent注册成功","func_name":"handler.agent.RegisterAgent","hostname":"test-agent-004","level":"info","message":"Agent注册成功","method":"POST","operation":"register_agent","option":"success","path":"/api/v1/agent/register","request_id":"","timestamp":"2025-11-05 14:13:32.751","type":"info","user_agent":"Apifox/1.0.0 (https://apifox.com)","user_id":0}
{"client_ip":"9.9.9.9","fields.message":"Processing CORS request","func_name":"middleware.security.GinCORSMiddleware","level":"info","message":"Processing CORS request","method":"GET","operation":"cors_middleware","option":"handle_cors_request","origin":"","path":"/api/v1/agent/neoscan-agent-001","request_id":"","timestamp":"2025-11-05 14:14:23.452","type":"info","user_id":0}
{"client_ip":"9.9.9.9","fields.message":"Setting security headers","func_name":"middleware.security.GinSecurityHeadersMiddleware","level":"info","message":"Setting security headers","method":"GET","operation":"security_headers","option":"set_security_headers","path":"/api/v1/agent/neoscan-agent-001","request_id":"","timestamp":"2025-11-05 14:14:23.452","type":"info","user_id":0}
{"level":"info","message":"Authentication requestmap[X-Request-ID: client_ip:9.9.9.9 func_name:middleware.auth.GinJWTAuthMiddleware method:GET path:/api/v1/agent/neoscan-agent-001 user_agent:Apifox/1.0.0 (https://apifox.com)]","timestamp":"2025-11-05 14:14:23.453"}
{"level":"info","message":"IP whitelist authentication passed map[client_ip:9.9.9.9 func_name:middleware.auth.GinAuthMiddleware]","timestamp":"2025-11-05 14:14:23.453"}
{"agent_id":"neoscan-agent-001","client_ip":"9.9.9.9","fields.message":"获取Agent信息成功","func_name":"handler.agent.GetAgentInfo","level":"info","message":"获取Agent信息成功","method":"GET","operation":"get_agent_info","option":"success","path":"/api/v1/agent/neoscan-agent-001","request_id":"","timestamp":"2025-11-05 14:14:23.456","type":"info","user_agent":"Apifox/1.0.0 (https://apifox.com)","user_id":0}
{"client_ip":"::1","fields.message":"Processing CORS request","func_name":"middleware.security.GinCORSMiddleware","level":"info","message":"Processing CORS request","method":"POST","operation":"cors_middleware","option":"handle_cors_request","origin":"","path":"/api/v1/agent/heartbeat","request_id":"","timestamp":"2025-11-05 14:15:30.282","type":"info","user_id":0}
{"client_ip":"::1","fields.message":"Setting security headers","func_name":"middleware.security.GinSecurityHeadersMiddleware","level":"info","message":"Setting security headers","method":"POST","operation":"security_headers","option":"set_security_headers","path":"/api/v1/agent/heartbeat","request_id":"","timestamp":"2025-11-05 14:15:30.283","type":"info","user_id":0}
{"agent_id":"test-agent","client_ip":"","fields.message":"Agent状态更新成功","func_name":"repo.agent.UpdateStatus","level":"info","message":"Agent状态更新成功","method":"","operation":"update_agent_status","option":"agentRepository.UpdateStatus","path":"repo.agent.UpdateStatus","request_id":"","status":"online","timestamp":"2025-11-05 14:15:30.467","type":"info","user_id":0}
{"agent_id":"test-agent","client_ip":"","fields.message":"Agent心跳时间更新成功","func_name":"repo.agent.UpdateLastHeartbeat","level":"info","message":"Agent心跳时间更新成功","method":"","operation":"update_heartbeat","option":"agentRepository.UpdateLastHeartbeat","path":"repo.agent.UpdateLastHeartbeat","request_id":"","timestamp":"2025-11-05 14:15:30.490","type":"info","user_id":0}
{"agent_id":"test-agent","client_ip":"","fields.message":"Agent性能指标更新成功","func_name":"repo.agent.UpdateAgentMetrics","level":"info","message":"Agent性能指标更新成功","method":"","operation":"update_agent_metrics","option":"agentRepository.UpdateAgentMetrics","path":"repo.agent.UpdateAgentMetrics","request_id":"","timestamp":"2025-11-05 14:15:30.499","type":"info","user_id":0}
{"agent_id":"test-agent","client_ip":"","fields.message":"Agent性能指标更新成功","func_name":"service.agent.monitor.ProcessHeartbeat","level":"info","message":"Agent性能指标更新成功","method":"","operation":"process_heartbeat","option":"agentRepo.UpdateAgentMetrics","path":"service.agent.monitor.ProcessHeartbeat","request_id":"","timestamp":"2025-11-05 14:15:30.499","type":"info","user_id":0}
{"agent_id":"test-agent","client_ip":"","fields.message":"Agent心跳处理成功","func_name":"service.agent.monitor.ProcessHeartbeat","level":"info","message":"Agent心跳处理成功","method":"","operation":"process_heartbeat","option":"ProcessHeartbeat","path":"service.agent.monitor.ProcessHeartbeat","request_id":"","status":"online","timestamp":"2025-11-05 14:15:30.499","type":"info","user_id":0}
{"agent_id":"test-agent","client_ip":"::1","fields.message":"处理Agent心跳成功","func_name":"handler.agent.ProcessHeartbeat","level":"info","message":"处理Agent心跳成功","method":"POST","operation":"process_heartbeat","option":"success","path":"/api/v1/agent/heartbeat","request_id":"","timestamp":"2025-11-05 14:15:30.499","type":"info","user_agent":"Apifox/1.0.0 (https://apifox.com)","user_id":0}
