{"client_ip":"","env":"development","fields.message":"NeoMaster application starting","fields.timestamp":"2025-10-17 19:05:45.558","level":"info","message":"Business operation: app_start","operation":"app_start","request_id":"","result":"success","timestamp":"2025-10-17 19:05:45.582","type":"business","user_id":0,"username":"","version":"1.0.0"}
{"client_ip":"","database":"neoscan_dev","fields.message":"MySQL database connected successfully","fields.timestamp":"2025-10-17 19:05:45.612","host":"localhost","level":"info","message":"Business operation: db_connect","operation":"mysql_connect","request_id":"","result":"success","timestamp":"2025-10-17 19:05:45.612","type":"business","user_id":0,"username":""}
{"client_ip":"","database":0,"fields.message":"Redis connected successfully","fields.timestamp":"2025-10-17 19:05:45.615","host":"localhost","level":"info","message":"Business operation: redis_connect","operation":"redis_connect","request_id":"","result":"success","timestamp":"2025-10-17 19:05:45.615","type":"business","user_id":0,"username":""}
{"client_ip":"127.0.0.5","fields.message":"Processing CORS request","func_name":"middleware.security.GinCORSMiddleware","level":"info","message":"Processing CORS request","method":"POST","operation":"cors_middleware","option":"handle_cors_request","origin":"","path":"/api/v1/auth/login","request_id":"","timestamp":"2025-10-17 19:05:59.008","type":"info","user_id":0}
{"client_ip":"127.0.0.5","fields.message":"Setting security headers","func_name":"middleware.security.GinSecurityHeadersMiddleware","level":"info","message":"Setting security headers","method":"POST","operation":"security_headers","option":"set_security_headers","path":"/api/v1/auth/login","request_id":"","timestamp":"2025-10-17 19:05:59.008","type":"info","user_id":0}
{"client_ip":"127.0.0.5","fields.message":"Request passed rate limit check","func_name":"middleware.ratelimit.GinRateLimitMiddlewareWithLimiter","level":"info","message":"Request passed rate limit check","method":"POST","operation":"rate_limit_check","option":"allow_request","path":"/api/v1/auth/login","request_id":"","timestamp":"2025-10-17 19:05:59.008","type":"info","user_id":0}
{"client_ip":"","expires_in":3600,"fields.message":"令牌生成成功","fields.timestamp":"2025-10-17 19:05:59.218","level":"info","message":"Business operation: generate_tokens","operation":"generate_tokens","permissions_count":13,"request_id":"","result":"success","roles":["admin"],"timestamp":"2025-10-17 19:05:59.218","token_prefix":"eyJhbGciOi...","type":"business","user_id":1,"username":"admin"}
{"client_ip":"127.0.0.5","email":"admin@neoscan.com","fields.message":"user login success","fields.timestamp":"2025-10-17 19:05:59.229","func_name":"handler.auth.login.Login","level":"info","message":"Business operation: user_login","operation":"login","option":"service:Login","request_id":"","result":"success","session_id":"eyJhbGciOi...","timestamp":"2025-10-17 19:05:59.229","type":"business","user_agent":"Apifox/1.0.0 (https://apifox.com)","user_id":1,"username":"admin"}
{"client_ip":"127.0.0.5","fields.message":"user login success","fields.timestamp":"2025-10-17 19:05:59.229","func_name":"handler.auth.login.Login","level":"info","message":"Business operation: user_login","operation":"user_login","option":"user_login:success","request_id":"","result":"success","timestamp":"2025-10-17 19:05:59.229","type":"business","user_agent":"Apifox/1.0.0 (https://apifox.com)","user_id":1,"username":"admin"}
{"X-Request-ID":"","client_ip":"127.0.0.5","duration":221,"fields.message":"API Request","fields.timestamp":"2025-10-17 19:05:59.230","level":"info","message":"Business operation: http_request","method":"POST","operation":"http_request","referer":"","request_id":"","request_size":79,"response_size":4357,"result":"success","status_code":200,"timestamp":"2025-10-17 19:05:59.230","type":"business","url":"/api/v1/auth/login","user_agent":"Apifox/1.0.0 (https://apifox.com)","user_id":0,"username":""}
{"client_ip":"::1","fields.message":"Processing CORS request","func_name":"middleware.security.GinCORSMiddleware","level":"info","message":"Processing CORS request","method":"POST","operation":"cors_middleware","option":"handle_cors_request","origin":"","path":"/agent/heartbeat","request_id":"","timestamp":"2025-10-17 19:06:40.568","type":"info","user_id":0}
{"client_ip":"::1","fields.message":"Setting security headers","func_name":"middleware.security.GinSecurityHeadersMiddleware","level":"info","message":"Setting security headers","method":"POST","operation":"security_headers","option":"set_security_headers","path":"/agent/heartbeat","request_id":"","timestamp":"2025-10-17 19:06:40.568","type":"info","user_id":0}
{"client_ip":"::1","fields.message":"Request passed rate limit check","func_name":"middleware.ratelimit.GinRateLimitMiddlewareWithLimiter","level":"info","message":"Request passed rate limit check","method":"POST","operation":"rate_limit_check","option":"allow_request","path":"/agent/heartbeat","request_id":"","timestamp":"2025-10-17 19:06:40.568","type":"info","user_id":0}
{"X-Request-ID":"","client_ip":"::1","duration":0,"fields.message":"API Request","fields.timestamp":"2025-10-17 19:06:40.568","level":"info","message":"Business operation: http_request","method":"POST","operation":"http_request","referer":"","request_id":"","request_size":1116,"response_size":-1,"result":"success","status_code":404,"timestamp":"2025-10-17 19:06:40.568","type":"business","url":"/agent/heartbeat","user_agent":"Apifox/1.0.0 (https://apifox.com)","user_id":0,"username":""}
{"X-Request-ID":"","client_ip":"::1","error":"HTTP 404: Not Found","fields.level":"error","fields.timestamp":"2025-10-17 19:06:40.568","level":"error","message":"System error occurred: HTTP 404: Not Found","method":"POST","operation":"http_request","path":"http_request","request_id":"","status_code":404,"timestamp":"2025-10-17 19:06:40.568","type":"error","url":"/agent/heartbeat","user_agent":"Apifox/1.0.0 (https://apifox.com)","user_id":0,"username":""}
{"client_ip":"::1","fields.message":"Processing CORS request","func_name":"middleware.security.GinCORSMiddleware","level":"info","message":"Processing CORS request","method":"POST","operation":"cors_middleware","option":"handle_cors_request","origin":"","path":"/api/v1/agent/heartbeat","request_id":"","timestamp":"2025-10-17 19:07:33.741","type":"info","user_id":0}
{"client_ip":"::1","fields.message":"Setting security headers","func_name":"middleware.security.GinSecurityHeadersMiddleware","level":"info","message":"Setting security headers","method":"POST","operation":"security_headers","option":"set_security_headers","path":"/api/v1/agent/heartbeat","request_id":"","timestamp":"2025-10-17 19:07:33.741","type":"info","user_id":0}
{"client_ip":"::1","fields.message":"Request passed rate limit check","func_name":"middleware.ratelimit.GinRateLimitMiddlewareWithLimiter","level":"info","message":"Request passed rate limit check","method":"POST","operation":"rate_limit_check","option":"allow_request","path":"/api/v1/agent/heartbeat","request_id":"","timestamp":"2025-10-17 19:07:33.741","type":"info","user_id":0}
{"agent_id":"test-agent","client_ip":"","fields.message":"Agent状态更新成功","func_name":"repo.agent.UpdateStatus","level":"info","message":"Agent状态更新成功","method":"","operation":"update_agent_status","option":"agentRepository.UpdateStatus","path":"repo.agent.UpdateStatus","request_id":"","status":"online","timestamp":"2025-10-17 19:07:33.747","type":"info","user_id":0}
{"agent_id":"test-agent","client_ip":"","fields.message":"Agent心跳时间更新成功","func_name":"repo.agent.UpdateLastHeartbeat","level":"info","message":"Agent心跳时间更新成功","method":"","operation":"update_heartbeat","option":"agentRepository.UpdateLastHeartbeat","path":"repo.agent.UpdateLastHeartbeat","request_id":"","timestamp":"2025-10-17 19:07:33.767","type":"info","user_id":0}
{"agent_id":"test-agent","client_ip":"","fields.message":"Agent性能指标创建成功","func_name":"repo.agent.UpdateAgentMetrics","level":"info","message":"Agent性能指标创建成功","method":"","operation":"create_agent_metrics","option":"agentRepository.UpdateAgentMetrics","path":"repo.agent.UpdateAgentMetrics","request_id":"","timestamp":"2025-10-17 19:07:33.832","type":"info","user_id":0}
{"agent_id":"test-agent","client_ip":"","fields.message":"Agent性能指标更新成功","func_name":"service.agent.monitor.ProcessHeartbeat","level":"info","message":"Agent性能指标更新成功","method":"","operation":"process_heartbeat","option":"agentRepo.UpdateAgentMetrics","path":"service.agent.monitor.ProcessHeartbeat","request_id":"","timestamp":"2025-10-17 19:07:33.832","type":"info","user_id":0}
{"agent_id":"test-agent","client_ip":"","fields.message":"Agent心跳处理成功","func_name":"service.agent.monitor.ProcessHeartbeat","level":"info","message":"Agent心跳处理成功","method":"","operation":"process_heartbeat","option":"ProcessHeartbeat","path":"service.agent.monitor.ProcessHeartbeat","request_id":"","status":"online","timestamp":"2025-10-17 19:07:33.832","type":"info","user_id":0}
{"agent_id":"test-agent","client_ip":"::1","fields.message":"处理Agent心跳成功","func_name":"handler.agent.ProcessHeartbeat","level":"info","message":"处理Agent心跳成功","method":"POST","operation":"process_heartbeat","option":"success","path":"/api/v1/agent/heartbeat","request_id":"","timestamp":"2025-10-17 19:07:33.832","type":"info","user_agent":"Apifox/1.0.0 (https://apifox.com)","user_id":0}
{"X-Request-ID":"","client_ip":"::1","duration":91,"fields.message":"API Request","fields.timestamp":"2025-10-17 19:07:33.832","level":"info","message":"Business operation: http_request","method":"POST","operation":"http_request","referer":"","request_id":"","request_size":1116,"response_size":221,"result":"success","status_code":200,"timestamp":"2025-10-17 19:07:33.832","type":"business","url":"/api/v1/agent/heartbeat","user_agent":"Apifox/1.0.0 (https://apifox.com)","user_id":0,"username":""}
